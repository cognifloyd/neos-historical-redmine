<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from forge.typo3.org/issues/54572 by HTTrack Website Copier/3.x [XR&CO'2008], Mon, 03 Aug 2015 22:16:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>Bug #54572: Neos deletes text parts on saving data - TYPO3.Neos - TYPO3 Forge</title>
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<link href="../themes/TYPO3/stylesheets/applicationfaba.css?1437165176" media="all" rel="stylesheet" type="text/css" />
<script src="../javascripts/prototypefaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/effectsfaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/dragdropfaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/controlsfaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/applicationfaba.js?1437165176" type="text/javascript"></script>
<script src="../plugin_assets/flow_design_helpers/javascripts/custom-scriptsf881.js?1437165331" type="text/javascript"></script>

<!--[if IE]>
    <style type="text/css">
      * html body{ width: expression( document.documentElement.clientWidth < 900 ? '900px' : '100%' ); }
      body {behavior: url(/stylesheets/csshover.htc?1437165176);}
    </style>
<![endif]-->
 <link href="../plugin_assets/redmine_backlogs/stylesheets/jquery/jquery.jqplot.minb674.css?1437165332" media="screen" rel="stylesheet" type="text/css" />

<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery-1.6.2.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery-ui-1.8.16.custom.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jeditable.minib674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.scrollfollowb674.js?1437165332" type="text/javascript"></script>

<!--[if IE]>
<script src="/plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/excanvas.js?1437165332" type="text/javascript"></script>
<![endif]-->
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/jquery.jqplotb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.highlighterb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.canvasTextRenderer.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.canvasAxisTickRenderer.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.enhancedLegendRenderer.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.cookieb674.js?1437165332" type="text/javascript"></script>

<script type="text/javascript"
        src="../rb/server_variables.js">
</script>
<script src="../plugin_assets/redmine_backlogs/javascripts/commonb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/burndownb674.js?1437165332" type="text/javascript"></script>


<style type="text/css">

</style>

<!-- page specific tags -->

    <link href="../../external.html?link=https://forge.typo3.org/issues/54572.atom" rel="alternate" title="TYPO3.Neos - Bug #54572: Neos deletes text parts on saving data" type="application/atom+xml" />
    <link href="../themes/TYPO3/stylesheets/scmfaba.css?1437165176" media="screen" rel="stylesheet" type="text/css" />
<script src="../javascripts/context_menufaba.js?1437165176" type="text/javascript"></script><link href="../stylesheets/context_menufaba.css?1437165176" media="screen" rel="stylesheet" type="text/css" /><script src="../javascripts/jstoolbar/jstoolbarfaba.js?1437165176" type="text/javascript"></script><script src="../javascripts/jstoolbar/textilefaba.js?1437165176" type="text/javascript"></script><script src="../javascripts/jstoolbar/lang/jstoolbar-enfaba.js?1437165176" type="text/javascript"></script><link href="../stylesheets/jstoolbarfaba.css?1437165176" media="screen" rel="stylesheet" type="text/css" /></head>
<body>
<div id="wrapper">
<div id="top-menu">
    <div id="account">
        <ul><li><a href="../../external.html?link=https://forge.typo3.org/login" class="login">Sign in</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/account/register" class="register">Register</a></li></ul>    </div>
    
    <ul><li><a href="../../external.html?link=https://forge.typo3.org/" class="home">Home</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects" class="projects">Projects</a></li>
<li><a href="../../external.html?link=http://www.redmine.org/guide" class="help">Help</a></li></ul></div>
      
<div id="header">
    <div id="header-left">
        <div id="header-menu">
            <a href="../../external.html?link=https://forge.typo3.org/" class="start">Start</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms" class="level-0 sorting-10">TYPO3 CMS</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3neos" class="level-0 current sorting-20">TYPO3 Neos</a><a href="../../external.html?link=https://forge.typo3.org/projects/flow3" class="level-0 sorting-20">TYPO3 Flow</a><a href="../../external.html?link=https://forge.typo3.org/projects/team-docteam" class="level-0 sorting-26">Documentation</a><a href="../../external.html?link=https://forge.typo3.org/projects/other" class="level-0 sorting-30">other</a>
        </div>
    </div>
    
    <div id="right-area"  style="">
        <div id="quick-search">
            <form action="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/search" method="get">
            <input name="issues" type="hidden" value="1" />
            <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/search" accesskey="4" style="">Search</a>:
            <input accesskey="f" class="small" id="q" name="q" size="20" type="text" />
            </form>
        </div>

        <h1>TYPO3.Neos</h1>
        <div id="quicklinks"></div>
    </div>
    
    <div id="main-menu">
        <input class="projectsearch placeholder" id="projectname_project" name="projectname[project]" onfocus="this.value = &quot;&quot;; $(this).removeClassName(&quot;placeholder&quot;);" size="30" type="text" value="Project title search" /><div class="auto_complete" id="projectname_project_auto_complete"></div><script type="text/javascript">
//<![CDATA[
var projectname_project_auto_completer = new Ajax.Autocompleter('projectname_project', 'projectname_project_auto_complete', '/projects/auto_complete', {afterUpdateElement:function(element, value) { var identNode = $(value).select(".identifier"); window.location.href="/projects/"+identNode[0].innerHTML }})
//]]>
</script>
        <ul><li><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos" class="overview">Overview</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/activity" class="activity">Activity</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/roadmap" class="roadmap">Roadmap</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/issues" class="issues selected">Issues</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/repository" class="repository">Repository</a></li></ul>
    </div>
</div>

<div class="" id="main">
    <div id="leftmenu">
        <a href="../../external.html?link=https://forge.typo3.org/projects/typo3neos-distribution-base" class="level-1 current sorting-0">Base Distribution</a><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-form" class="level-2 sorting-0">TYPO3.Form</a><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-imagine" class="level-2 sorting-0">TYPO3.Imagine</a><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-media" class="level-2 sorting-0">TYPO3.Media</a><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos" class="level-2 current sorting-0">TYPO3.Neos</a><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos-nodetypes" class="level-2 sorting-0">TYPO3.Neos.NodeTypes</a><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-party" class="level-2 sorting-0">TYPO3.Party</a><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-setup" class="level-2 sorting-0">TYPO3.Setup</a><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-sitekickstarter" class="level-2 sorting-0">TYPO3.SiteKickstarter</a><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-twitter-bootstrap" class="level-2 sorting-0">TYPO3.Twitter.Bootstrap</a><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neoscr" class="level-2 sorting-0">TYPO3.TYPO3CR</a><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-typoscript" class="level-2 sorting-0">TYPO3.TypoScript</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3neos-coordination" class="level-1 sorting-0">Coordination Group</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3neos-website-communication" class="level-1 sorting-0">Website and Communication</a>
    </div>
    <div id="sidebar">        
        
  <h3>Issues</h3>
<a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/issues?set_filter=1">View all issues</a><br />

<a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/issues/report">Summary</a><br />







<h3>Custom queries</h3><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/issues?query_id=133" class="query">Hierarchical Issues</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/issues?query_id=322" class="query">Most wanted Bugfixes</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/issues?query_id=321" class="query">Most wanted Features</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/issues?query_id=167" class="query">My open issues</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/issues?query_id=203" class="query">New &amp; Unassigned</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/issues?query_id=90" class="query">Open Bugs</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/issues?query_id=204" class="query">Recently modified</a>



  

        
    </div>
    
    <div id="content">
				
        <div class="contextual">


<span class="issue-54572-watcher"></span>


</div>


<h2>Bug #54572</h2>

<div class="issue status-9 priority-2 closed details">
  

  

<div class="subject">
<div><h3>Neos deletes text parts on saving data</h3></div>
</div>
        <p class="author">
        Added by <a href="../../external.html?link=https://forge.typo3.org/users/36575">Alexander Schnitzler</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/activity?from=2013-12-22" title="2013-12-22 16:01">over 1 year</a> ago.
        
        Updated <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/activity?from=2015-03-20" title="2015-03-20 11:08">5 months</a> ago.
        
        </p>

<table class="attributes">
<tr>
    <th class="status">Status:</th><td class="status">Closed</td>
    <th class="start-date">Start date:</th><td class="start-date">2013-12-22</td>
</tr>
<tr>
    <th class="priority">Priority:</th><td class="priority">Should have</td>
    <th class="due-date">Due date:</th><td class="due-date"></td>
</tr>
<tr>
    <th class="assigned-to">Assigned To:</th><td class="assigned-to"><a href="../../external.html?link=https://forge.typo3.org/users/1295">Dominique Feyer</a></td>
    <th class="progress">% Done:</th><td class="progress"><table class="progress" style="width: 80px;"><tr><td class="todo" style="width: 100%;"></td></tr></table><p class="pourcent">0%</p></td>
</tr>
<tr>
    <th class="category">Category:</th><td class="category">-</td>
    
    <th></th>
    <td></td>
    
</tr>
<tr>
    <th class="fixed-version">Target version:</th><td class="fixed-version"><a href="../../external.html?link=https://forge.typo3.org/versions/2313">Base Distribution - 1.x</a></td>
    
</tr>


</table>

<hr />

  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>I am using the blog plugin of Robert Lemke which add's blog posts as new documents and comments als child nodes.</p>


	<p>If a user posts a comment I can log into the backend and edit the comment inline as well as changing data via the inspector.</p>


	<p>Depending on the text of the comment itself, parts of the text will be deleted on applying any change.</p>


	<p>The comment text:<br /><pre>
Hi alex,
thanks for this nice tutorial.
I found a small problem at the end of you article.
&lt;f:translate key="error.{field.propertyName}.{field.errorCode}" ... This will only work if your property is lowercase only. If you use lower-camelcase like myTestProperty it wonâ€™t work because you will have to convert it to my_test_property. Did you have any solution for this?

Thanks
Alex
</pre></p>


	<p>The comment text will be processed by htmlentities and nl2br which results in:<br /><pre>
Hi alex&amp;comma;&lt;br /&gt;
&amp;NewLine;thanks for this nice tutorial&amp;period;&lt;br /&gt;
&amp;NewLine;I found a small problem at the end of you article&amp;period;&lt;br /&gt;
&amp;NewLine;&amp;lt;f&amp;colon;translate key&amp;equals;&amp;quot;error&amp;period;&amp;lbrace;field&amp;period;propertyName&amp;rcub;&amp;period;&amp;lbrace;field&amp;period;errorCode&amp;rcub;&amp;quot; &amp;period;&amp;period;&amp;period; This will only work if your property is lowercase only&amp;period; If you use lower-camelcase like myTestProperty it won&amp;rsquo;t work because you will have to convert it to my&amp;lowbar;test&amp;lowbar;property&amp;period; Did you have any solution for this&amp;quest;&lt;br /&gt;
&amp;NewLine;&lt;br /&gt;
&amp;NewLine;Thanks&lt;br /&gt;
&amp;NewLine;Alex
</pre></p>


	<p>So the whole comment data inside the node repository is this:<br /><pre>
a:5:{s:6:"author";s:4:"Alex";s:12:"emailAddress";s:11:"mail@foo.de";s:4:"text";s:630:"Hi alex&amp;comma;&lt;br /&gt;
&amp;NewLine;thanks for this nice tutorial&amp;period;&lt;br /&gt;
&amp;NewLine;I found a small problem at the end of you article&amp;period;&lt;br /&gt;
&amp;NewLine;&amp;lt;f&amp;colon;translate key&amp;equals;&amp;quot;error&amp;period;&amp;lbrace;field&amp;period;propertyName&amp;rcub;&amp;period;&amp;lbrace;field&amp;period;errorCode&amp;rcub;&amp;quot; &amp;period;&amp;period;&amp;period; This will only work if your property is lowercase only&amp;period; If you use lower-camelcase like myTestProperty it won&amp;rsquo;t work because you will have to convert it to my&amp;lowbar;test&amp;lowbar;property&amp;period; Did you have any solution for this&amp;quest;&lt;br /&gt;
&amp;NewLine;&lt;br /&gt;
&amp;NewLine;Thanks&lt;br /&gt;
&amp;NewLine;Alex";s:4:"spam";b:0;s:13:"datePublished";O:8:"DateTime":3:{s:4:"date";s:19:"2013-12-22 14:53:06";s:13:"timezone_type";i:3;s:8:"timezone";s:13:"Europe/Berlin";}}
</pre></p>


	<p>When applying any change the text will be changed as such:<br /><pre>
Hi alex,&lt;br/&gt;

thanks for this nice tutorial.&lt;br/&gt;

I found a small problem at the end of you article.&lt;br/&gt;

&lt;br/&gt;

Thanks&lt;br/&gt;

Alex
</pre></p>


	<p>Data inside the node repository:<br /><pre>
a:5:{s:6:"author";s:5:"Alex ";s:12:"emailAddress";s:11:"mail@foo.de";s:4:"text";s:135:"Hi alex,&lt;br/&gt;

thanks for this nice tutorial.&lt;br/&gt;

I found a small problem at the end of you article.&lt;br/&gt;

&lt;br/&gt;

Thanks&lt;br/&gt;

Alex";s:4:"spam";b:0;s:13:"datePublished";O:8:"DateTime":3:{s:4:"date";s:19:"2013-12-22 00:00:00";s:13:"timezone_type";i:3;s:8:"timezone";s:13:"Europe/Berlin";}}
</pre></p>


	<p>Maybe someone can tell me how the data is process before it's saved inside the database to find out what's going on in detail there.</p>
  </div>









</div>




<div id="history">
<h3>History</h3>

  <div id="change-253220" class="journal has-notes has-details">
    <h4><a href="54572.html#note-1" class="journal-link">#1</a>
    
    <a name="note-1"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/1295">Dominique Feyer</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-neos/activity?from=2015-03-20" title="2015-03-20 11:08">5 months</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Status</strong> changed from <i>New</i> to <i>Closed</i></li>
      
       <li><strong>Assigned To</strong> set to <i>Dominique Feyer</i></li>
      
    </ul>
    
    <div class="wiki" id="journal-253220-notes"><p>Hi Alex,</p>


	<p>So you post a comment with a Fluid viewhelper inside, right ?</p>


	<p>Sounds logic that Neos process the fluid viewhelper on rendering, and after edition the comment this part will be gone.</p>


	<p>The bug here is not related to Neos, but the the Blog plugin, who don't cleanup correctly the content of a comment (HTML code must be cleanup to allow only some HTML elements), if you can reproduce with a recent version of Neos and Blog package, please open an issue on github: <a class="external" href="../../external.html?link=https://github.com/robertlemke/RobertLemke.Plugin.Blog">https://github.com/robertlemke/RobertLemke.Plugin.Blog</a></p>


	<p>I close this issue, if you don't agree with my comment feel free to open an issue on Jira, jira.typo3.org, (forge is not used any more for Flow and Neos), and add a link to this issue.</p></div>
  </div>
  




</div>



<div style="clear: both;"></div>
<div class="contextual">


<span class="issue-54572-watcher"></span>


</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:
  <span><a href="../../external.html?link=https://forge.typo3.org/issues/54572.atom" class="atom" rel="nofollow">Atom</a></span>
  <span><a href="54572.pdf" class="pdf" rel="nofollow">PDF</a></span>
</p>







<script type="text/javascript">
//<![CDATA[
new ContextMenu('/issues/context_menu')
//]]>
</script>

        
				<div style="clear:both;"></div>
    </div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>
	
<div id="footer">
 Powered by <a href="../../external.html?link=http://www.redmine.org/">Redmine</a> &copy; 2006-2012 Jean-Philippe Lang<br /><br />
 Hosting sponsor:<br /><br />
 <script type="text/javascript">var buttonStyle = "footer-grey-31";</script>
 <script src="../../typo3.org/fileadmin/t3org/images/FM-content/team-pages/server-team/sponsor-banners/sponsors.js"></script>
</div>
</div>

<script type="text/javascript">
    var pkBaseURL = (("https:" == document.location.protocol) ? "https://piwik.typo3.org/" : "http://piwik.typo3.org/");
    document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
    try {
        var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 14);
        piwikTracker.trackPageView();
        piwikTracker.enableLinkTracking();
    } catch( err ) {}
</script>
<noscript><span style="visibility: hidden";><img src="../../external.html?link=http://piwik.typo3.org/piwik.php?idsite=14" style="border:0" alt=""/></span></noscript>
</body>

<!-- Mirrored from forge.typo3.org/issues/54572 by HTTrack Website Copier/3.x [XR&CO'2008], Mon, 03 Aug 2015 22:16:36 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
</html>
