<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from forge.typo3.org/issues/59192 by HTTrack Website Copier/3.x [XR&CO'2008], Mon, 03 Aug 2015 22:53:17 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>Bug #59192: mergeIfNotBlank with FAL records - Core - TYPO3 Forge</title>
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<link href="../themes/TYPO3/stylesheets/applicationfaba.css?1437165176" media="all" rel="stylesheet" type="text/css" />
<script src="../javascripts/prototypefaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/effectsfaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/dragdropfaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/controlsfaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/applicationfaba.js?1437165176" type="text/javascript"></script>
<script src="../plugin_assets/flow_design_helpers/javascripts/custom-scriptsf881.js?1437165331" type="text/javascript"></script>

<!--[if IE]>
    <style type="text/css">
      * html body{ width: expression( document.documentElement.clientWidth < 900 ? '900px' : '100%' ); }
      body {behavior: url(/stylesheets/csshover.htc?1437165176);}
    </style>
<![endif]-->
 <link href="../plugin_assets/redmine_backlogs/stylesheets/jquery/jquery.jqplot.minb674.css?1437165332" media="screen" rel="stylesheet" type="text/css" />

<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery-1.6.2.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery-ui-1.8.16.custom.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jeditable.minib674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.scrollfollowb674.js?1437165332" type="text/javascript"></script>

<!--[if IE]>
<script src="/plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/excanvas.js?1437165332" type="text/javascript"></script>
<![endif]-->
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/jquery.jqplotb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.highlighterb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.canvasTextRenderer.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.canvasAxisTickRenderer.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.enhancedLegendRenderer.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.cookieb674.js?1437165332" type="text/javascript"></script>

<script type="text/javascript"
        src="../rb/server_variables.js">
</script>
<script src="../plugin_assets/redmine_backlogs/javascripts/commonb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/burndownb674.js?1437165332" type="text/javascript"></script>


<style type="text/css">

</style>

<!-- page specific tags -->

    <link href="../../external.html?link=https://forge.typo3.org/issues/59192.atom" rel="alternate" title="Core - Bug #59192: mergeIfNotBlank with FAL records" type="application/atom+xml" />
    <link href="../themes/TYPO3/stylesheets/scmfaba.css?1437165176" media="screen" rel="stylesheet" type="text/css" />
<script src="../javascripts/context_menufaba.js?1437165176" type="text/javascript"></script><link href="../stylesheets/context_menufaba.css?1437165176" media="screen" rel="stylesheet" type="text/css" /><script src="../javascripts/jstoolbar/jstoolbarfaba.js?1437165176" type="text/javascript"></script><script src="../javascripts/jstoolbar/textilefaba.js?1437165176" type="text/javascript"></script><script src="../javascripts/jstoolbar/lang/jstoolbar-enfaba.js?1437165176" type="text/javascript"></script><link href="../stylesheets/jstoolbarfaba.css?1437165176" media="screen" rel="stylesheet" type="text/css" /></head>
<body>
<div id="wrapper">
<div id="top-menu">
    <div id="account">
        <ul><li><a href="../../external.html?link=https://forge.typo3.org/login" class="login">Sign in</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/account/register" class="register">Register</a></li></ul>    </div>
    
    <ul><li><a href="../../external.html?link=https://forge.typo3.org/" class="home">Home</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects" class="projects">Projects</a></li>
<li><a href="../../external.html?link=http://www.redmine.org/guide" class="help">Help</a></li></ul></div>
      
<div id="header">
    <div id="header-left">
        <div id="header-menu">
            <a href="../../external.html?link=https://forge.typo3.org/" class="start">Start</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms" class="level-0 current sorting-10">TYPO3 CMS</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3neos" class="level-0 sorting-20">TYPO3 Neos</a><a href="../../external.html?link=https://forge.typo3.org/projects/flow3" class="level-0 sorting-20">TYPO3 Flow</a><a href="../../external.html?link=https://forge.typo3.org/projects/team-docteam" class="level-0 sorting-26">Documentation</a><a href="../../external.html?link=https://forge.typo3.org/projects/other" class="level-0 sorting-30">other</a>
        </div>
    </div>
    
    <div id="right-area"  style="">
        <div id="quick-search">
            <form action="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/search" method="get">
            <input name="issues" type="hidden" value="1" />
            <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/search" accesskey="4" style="">Search</a>:
            <input accesskey="f" class="small" id="q" name="q" size="20" type="text" />
            </form>
        </div>

        <h1>Core</h1>
        <div id="quicklinks"><p>Development of TYPO3 CMS</p></div>
    </div>
    
    <div id="main-menu">
        <input class="projectsearch placeholder" id="projectname_project" name="projectname[project]" onfocus="this.value = &quot;&quot;; $(this).removeClassName(&quot;placeholder&quot;);" size="30" type="text" value="Project title search" /><div class="auto_complete" id="projectname_project_auto_complete"></div><script type="text/javascript">
//<![CDATA[
var projectname_project_auto_completer = new Ajax.Autocompleter('projectname_project', 'projectname_project_auto_complete', '/projects/auto_complete', {afterUpdateElement:function(element, value) { var identNode = $(value).select(".identifier"); window.location.href="/projects/"+identNode[0].innerHTML }})
//]]>
</script>
        <ul><li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core" class="overview">Overview</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity" class="activity">Activity</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/roadmap" class="roadmap">Roadmap</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues" class="issues selected">Issues</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/wiki" class="wiki">Wiki</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/repository" class="repository">Repository</a></li></ul>
    </div>
</div>

<div class="" id="main">
    <div id="leftmenu">
        <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core" class="level-1 current sorting-10">Core</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3v4-search" class="level-2 sorting-0">Indexed Search</a><a href="../../external.html?link=https://forge.typo3.org/projects/extension-linkvalidator" class="level-2 sorting-0">Linkvalidator</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-releasecycles" class="level-2 sorting-0">Release Cycles</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-team" class="level-2 sorting-0">Team Resources</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3v4-workspaces" class="level-2 sorting-0">Workspaces & Versioning</a><a href="../../external.html?link=https://forge.typo3.org/projects/usability" class="level-2 sorting-10">TYPO3 CMS Usability Team</a><a href="../../external.html?link=https://forge.typo3.org/projects/extensions" class="level-1 sorting-20">Community Extensions</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3v4-distribution" class="level-1 sorting-44">Distributions</a><a href="../../external.html?link=https://forge.typo3.org/projects/cms-feature-requests" class="level-1 sorting-50">Feature-Requests</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-v62" class="level-1 sorting-620">TYPO3 6.2 Projects (+)</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-archived" class="level-1 sorting-1000">(Archived Projects)</a>
    </div>
    <div id="sidebar">        
        
  <h3>Issues</h3>
<a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?set_filter=1">View all issues</a><br />

<a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues/report">Summary</a><br />







<h3>Custom queries</h3><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=219" class="query">Easy tasks</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=391" class="query">FAL Issues</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=133" class="query">Hierarchical Issues</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=322" class="query">Most wanted Bugfixes</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=321" class="query">Most wanted Features</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=167" class="query">My open issues</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=203" class="query">New &amp; Unassigned</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=90" class="query">Open Bugs</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=204" class="query">Recently modified</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=523" class="query">Regressions</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=459" class="query">Roadmap v7</a>



  
    <div id="watchers">
      

<h3>Watchers (13)</h3>

<ul><li><a href="../../external.html?link=https://forge.typo3.org/users/128">Georg Ringer</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/2775">Lorenz Ulrich</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/2125">Jonas Renggli</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/4192">Anja Leichsenring</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/3883">Viktor Livakivskyi</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/40783">Gerd Müller</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/2787">Frans Saris</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/522">Markus Timtner</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/2793">Georg Rienzner</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/459">Ben Robinson</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/2737">Andreas Kiessling</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/5046">Jasmina Ließmann</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/5287">Sascha Friedl</a></li></ul>

    </div>
  

        
    </div>
    
    <div id="content">
				
        <div class="contextual">


<span class="issue-59192-watcher"></span>


</div>


<h2>Bug #59192</h2>

<div class="issue status-2 priority-2 details">
  

  

<div class="subject">
<div><h3>mergeIfNotBlank with FAL records</h3></div>
</div>
        <p class="author">
        Added by <a href="../../external.html?link=https://forge.typo3.org/users/2775">Lorenz Ulrich</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-05-28" title="2014-05-28 22:55">about 1 year</a> ago.
        
        Updated <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2015-03-23" title="2015-03-23 11:49">4 months</a> ago.
        
        </p>

<table class="attributes">
<tr>
    <th class="status">Status:</th><td class="status">Accepted</td>
    <th class="start-date">Start date:</th><td class="start-date">2014-05-28</td>
</tr>
<tr>
    <th class="priority">Priority:</th><td class="priority">Should have</td>
    <th class="due-date">Due date:</th><td class="due-date"></td>
</tr>
<tr>
    <th class="assigned-to">Assigned To:</th><td class="assigned-to">-</td>
    <th class="progress">% Done:</th><td class="progress"><table class="progress" style="width: 80px;"><tr><td class="todo" style="width: 100%;"></td></tr></table><p class="pourcent">0%</p></td>
</tr>
<tr>
    <th class="category">Category:</th><td class="category">File Abstraction Layer (FAL)</td>
    
    <th class="spent-time">Spent time:</th>
    <td class="spent-time">-</td>
    
</tr>
<tr>
    <th class="fixed-version">Target version:</th><td class="fixed-version">-</td>
    
</tr>
<tr>
	<th>TYPO3 Version:</th><td>6.2</td>
	<th>Is Regression:</th><td>No</td>
</tr>
<tr>
	<th>PHP Version:</th><td></td>
	<th>Sprint Focus:</th><td></td>
</tr>
<tr>
	<th>Complexity:</th><td></td>
</tr>


</table>

<hr />

  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>mergeIfNotBlank doesn't seem to play with FAL records. I'm using EXT:news with FAL relations enabled (default as of 3.0). There are two FAL fields:</p>


	<p>- Media file (fal_media)<br />- Related files (fal_related_files)</p>


	<p>Both are using <code>ExtensionManagementUtility::getFileFieldTCAConfig</code> for their file field.</p>


	<p>The <a href="../../external.html?link=http://docs.typo3.org/typo3cms/TCAReference/Reference/Columns/Index.html?highlight=l10n_mode#l10n-mode" class="external">TCA reference</a> states the following: "Field will be editable but if the field value is blank the value from the default translation is used (this can be very useful for images shared from the default record). Requires frontend support. In the backend the effect is that the field content is not copied when a new "localization copy" is made."</p>


	<p>From my understanding, applied to a FAL field this means the following when I localize an item:</p>


	<a name="Scenario-A-I-just-want-to-use-the-files-from-the-original-version"></a>
<h2 >Scenario A: I just want to use the files from the original version<a href="#Scenario-A-I-just-want-to-use-the-files-from-the-original-version" class="wiki-anchor">&para;</a></h2>


	<p><strong>Expectation:</strong></p>


	<p>The sys_file_references are not copied. I see an information about the items that are going to be used if I don't set any new relations:</p>


	<p><img src="../attachments/download/26824.png" alt="" /></p>


	<p>When I view the localized news, the files from the original version are visible.</p>


	<p><strong>Current behaviour, sys_language_mode=strict:</strong></p>


	<ul>
	<li>I don't see any information about the files being used if I don't set any new relations.</li>
		<li>I have no files in the frontend output at all.</li>
	</ul>


	<p><strong>Current behaviour, sys_language_mode=content_fallback:</strong></p>


	<ul>
	<li>I don't see any information about the files being used if I don't set any new relations.</li>
		<li>I can see the file references.</li>
	</ul>


	<a name="Scenario-B-I-want-to-use-own-files-for-the-localized-version"></a>
<h2 >Scenario B: I want to use own files for the localized version<a href="#Scenario-B-I-want-to-use-own-files-for-the-localized-version" class="wiki-anchor">&para;</a></h2>


	<p><strong>Expectation:</strong></p>


	<p>I add own files. Since the fields are no longer blank in the localized version, only the localized files I added will be displayed.</p>


	<p><strong>Current behaviour, sys_language_mode=strict:</strong></p>


	<p>No files are displayed at all.</p>


	<p><strong>Current behaviour, sys_language_mode=content_fallback:</strong></p>


	<p>The files from the default language are displayed, the files from the localized version are ignored.</p>


	<a name="Possible-workaround"></a>
<h2 >Possible workaround<a href="#Possible-workaround" class="wiki-anchor">&para;</a></h2>


	<p>The only way I can add files at all in a translated item is to change the TCA definition of the field to display the localization buttons:</p>


<pre>
    $TCA['tx_news_domain_model_news']['columns']['fal_related_files'] = array(
        'exclude' =&gt; 1,
        'l10n_mode' =&gt; 'mergeIfNotBlank',
        'label' =&gt; '' . $ll . 'tx_news_domain_model_news.fal_related_files',
        'config' =&gt; \TYPO3\CMS\Core\Utility\ExtensionManagementUtility::getFileFieldTCAConfig(
            'related_files',
            array(
                'appearance' =&gt; array(
                    'showAllLocalizationLink' =&gt; 1,
                    'showSynchronizationLink' =&gt; 1,
                )
            )
        )
    );
</pre>

	<p>Then I see the files from the original language.</p>


	<p><img src="../attachments/download/26825.png" alt="" /></p>


	<p><strong>sys_language_mode=strict:</strong> They are still not displayed in the frontend as it would be expected for "mergeIfNotBlank" fields.</p>


	<p>Once I localize the references, the files are displayed. But the meta information is always taken from the default language and cannot be overridden:</p>


	<p><img src="../attachments/download/26826.png" alt="" /></p>


	<p>Relations that only exist in the localized version are still not displayed at all (both language modes).</p>


	<p>I don't know if these are mostly Extbase or non-Extbase issues.</p>
  </div>

<div class="attachments">

<p><a href="../attachments/download/26824/mergeifnotblank-information.png" class="icon icon-attachment">mergeifnotblank-information.png</a>  
  
  <span class="size">(7.8 kB)</span>
  
  
    <span class="author">Lorenz Ulrich, 2014-05-28 22:55</span>
  
  </p>

<p><a href="../attachments/download/26825/fal-localized-buttons.png" class="icon icon-attachment">fal-localized-buttons.png</a>  
  
  <span class="size">(12.9 kB)</span>
  
  
    <span class="author">Lorenz Ulrich, 2014-05-28 22:55</span>
  
  </p>

<p><a href="../attachments/download/26826/fal-override-notworking.png" class="icon icon-attachment">fal-override-notworking.png</a>  
  
  <span class="size">(25.2 kB)</span>
  
  
    <span class="author">Lorenz Ulrich, 2014-05-28 22:55</span>
  
  </p>

</div>







<hr />
<div id="relations">
<div class="contextual">

</div>

<p><strong>Related issues</strong></p>


<form>
<table class="list issues">

<tr class="issue hascontextmenu" id="relation-11270">
<td class="checkbox"><input name="ids[]" type="checkbox" value="58352" /></td>
<td class="subject">related to 
    Core - 
    <a href="58352.html" class="issue status-7 priority-2 closed">Bug #58352</a>: Invalid localization overlay of cObject FILES
</td>
<td class="status">Resolved</td>
<td class="start_date">2014-04-30</td>
<td class="due_date"></td>
<td class="buttons"></td>
</tr>

<tr class="issue hascontextmenu" id="relation-11237">
<td class="checkbox"><input name="ids[]" type="checkbox" value="57021" /></td>
<td class="subject">related to 
    news extension - 
    <a href="57021.html" class="issue status-10 priority-1 closed">Bug #57021</a>: FAL media files in translated news records don&#39;t work
</td>
<td class="status">Rejected</td>
<td class="start_date">2014-03-18</td>
<td class="due_date"></td>
<td class="buttons"></td>
</tr>

<tr class="issue hascontextmenu" id="relation-11238">
<td class="checkbox"><input name="ids[]" type="checkbox" value="57272" /></td>
<td class="subject">related to 
    Core - 
    <a href="57272.html" class="issue status-6 priority-1">Bug #57272</a>: Extbase doesn&#39;t handle FAL translations correctly
</td>
<td class="status">Under Review</td>
<td class="start_date">2014-03-25</td>
<td class="due_date"></td>
<td class="buttons"></td>
</tr>

<tr class="issue hascontextmenu" id="relation-11837">
<td class="checkbox"><input name="ids[]" type="checkbox" value="62155" /></td>
<td class="subject">related to 
    Core - 
    <a href="62155.html" class="issue status-10 priority-1 closed">Bug #62155</a>: IRRE at localized records not working properly with Extba...
</td>
<td class="status">Rejected</td>
<td class="start_date">2014-10-10</td>
<td class="due_date"></td>
<td class="buttons"></td>
</tr>

<tr class="issue hascontextmenu" id="relation-11952">
<td class="checkbox"><input name="ids[]" type="checkbox" value="59972" /></td>
<td class="subject">related to 
    Core - 
    <a href="59972.html" class="issue status-7 priority-2 closed">Bug #59972</a>: Invalid mergeIfNotBlank usage in sys_file_reference TCA
</td>
<td class="status">Resolved</td>
<td class="start_date">2014-06-29</td>
<td class="due_date"></td>
<td class="buttons"></td>
</tr>

</table>
</form>


<form action="../../external.html?link=https://forge.typo3.org/issues/59192/relations" id="new-relation-form" method="post" onsubmit="new Ajax.Request('/issues/59192/relations', {asynchronous:true, evalScripts:true, method:'post', onComplete:function(request){Form.Element.focus('relation_issue_to_id');}, parameters:Form.serialize(this)}); return false;" style="display: none;"><div style="margin:0;padding:0;display:inline"><input name="authenticity_token" type="hidden" value="IjgAk+sryuS7AAkPn7/ITUV652f6cwFBHN6GNTvW7o8=" /></div>


<p><select id="relation_relation_type" name="relation[relation_type]" onchange="setPredecessorFieldsVisibility();"><option value="relates">related to</option>
<option value="duplicates">duplicates</option>
<option value="duplicated">duplicated by</option>
<option value="blocks">blocks</option>
<option value="blocked">blocked by</option>
<option value="precedes">precedes</option>
<option value="follows">follows</option></select>
Issue #<input id="relation_issue_to_id" name="relation[issue_to_id]" size="10" type="text" />
<span id="predecessor_fields" style="display:none;">
Delay: <input id="relation_delay" name="relation[delay]" size="3" type="text" /> days
</span>
<input name="commit" type="submit" value="Add" />
<a href="#" onclick="Element.toggle('new-relation-form'); this.blur(); return false;">Cancel</a>
</p>

<div id="related_issue_candidates" class="autocomplete"></div>
<script type="text/javascript">
//<![CDATA[
observeRelatedIssueField('/issues/auto_complete?id=59192&amp;project_id=typo3cms-core')
//]]>
</script>

<script type="text/javascript">
//<![CDATA[
setPredecessorFieldsVisibility();
//]]>
</script>

</form>

</div>


</div>




<div id="history">
<h3>History</h3>

  <div id="change-219258" class="journal has-details">
    <h4><a href="59192.html#note-1" class="journal-link">#1</a>
    
    <a name="note-1"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/3351">Markus Klein</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-06-04" title="2014-06-04 17:18">about 1 year</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Status</strong> changed from <i>New</i> to <i>Accepted</i></li>
      
    </ul>
    
    
  </div>
  

  <div id="change-219268" class="journal has-notes">
    <h4><a href="59192.html#note-2" class="journal-link">#2</a>
    
    <a name="note-2"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/35">Oliver Hader</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-06-04" title="2014-06-04 18:05">about 1 year</a> ago</h4>

    
    <div class="wiki" id="journal-219268-notes"><p>I'll hava a look into that... I'm trying to reproduce that with the Git version of EXT:news...<br />In IRRE there's the localizationMode which can be set to "keep" or "select", what should describe both of your scenarios.<br />The frontend-handling of sys_file_reference overlays seems to be missing in the FAL area - compare that to FileMetadataOverlayAspect which is triggered in MetaDataRepository::findByFileUid()...</p></div>
  </div>
  

  <div id="change-239264" class="journal has-details">
    <h4><a href="59192.html#note-3" class="journal-link">#3</a>
    
    <a name="note-3"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/702">Ingo Schmitt</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-12-06" title="2014-12-06 20:41">8 months</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Category</strong> set to <i>File Abstraction Layer (FAL)</i></li>
      
    </ul>
    
    
  </div>
  

  <div id="change-253321" class="journal has-notes">
    <h4><a href="59192.html#note-4" class="journal-link">#4</a>
    
    <a name="note-4"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/43">Andreas Wolf</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2015-03-22" title="2015-03-22 11:12">4 months</a> ago</h4>

    
    <div class="wiki" id="journal-253321-notes"><p>To me, this looks like the exact error described (and partly fixed) in <a href="57272.html" class="issue status-6 priority-1" title="Extbase doesn't handle FAL translations correctly (Under Review)">#57272</a>.</p>


	<p>@Lorenz: can you try the patch created by Frans and Helmut (<a class="external" href="../../external.html?link=https://review.typo3.org/#/c/32718">https://review.typo3.org/#/c/32718</a>) and see if it fixes your problem? Handling of IRRE translations is currently broken (as in "not implemented") in Extbase. The most notable example for this is FAL references, but other use cases also won’t work.</p>


	<p>The whole situation is pretty complicated, as there are different options for configuring the frontend output, some of which are not at all respected by Extbase currently.</p></div>
  </div>
  

  <div id="change-253322" class="journal has-notes">
    <h4><a href="59192.html#note-5" class="journal-link">#5</a>
    
    <a name="note-5"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/43">Andreas Wolf</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2015-03-22" title="2015-03-22 11:15">4 months</a> ago</h4>

    
    <div class="wiki" id="journal-253322-notes"><p>Andreas Wolf wrote:</p>


<blockquote>

	<p>@Lorenz: can you try the patch created by Frans and Helmut (<a class="external" href="../../external.html?link=https://review.typo3.org/#/c/32718">https://review.typo3.org/#/c/32718</a>) and see if it fixes your problem? Handling of IRRE translations is currently broken (as in "not implemented") in Extbase. The most notable example for this is FAL references, but other use cases also won’t work.</p>


</blockquote>

	<p>Ah, sorry. I just saw that you already replied in the issue. I'm currently working on this topic – if it’s still relevant for you, just ping me on Slack or vie E-Mail so we can discuss your findings.</p></div>
  </div>
  

  <div id="change-253473" class="journal has-notes">
    <h4><a href="59192.html#note-6" class="journal-link">#6</a>
    
    <a name="note-6"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/2775">Lorenz Ulrich</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2015-03-23" title="2015-03-23 11:49">4 months</a> ago</h4>

    
    <div class="wiki" id="journal-253473-notes"><p>Andreas Wolf wrote:</p>


<blockquote>

	<p>To me, this looks like the exact error described (and partly fixed) in <a href="57272.html" class="issue status-6 priority-1" title="Extbase doesn't handle FAL translations correctly (Under Review)">#57272</a>.</p>


	<p>@Lorenz: can you try the patch created by Frans and Helmut (<a class="external" href="../../external.html?link=https://review.typo3.org/#/c/32718">https://review.typo3.org/#/c/32718</a>) and see if it fixes your problem? Handling of IRRE translations is currently broken (as in "not implemented") in Extbase. The most notable example for this is FAL references, but other use cases also won’t work.</p>


	<p>The whole situation is pretty complicated, as there are different options for configuring the frontend output, some of which are not at all respected by Extbase currently.</p>


</blockquote>

	<p>Thanks for your effort in bringing this in. As you noticed and I wrote in <a href="57272.html" class="issue status-6 priority-1" title="Extbase doesn't handle FAL translations correctly (Under Review)">#57272</a>, the patch solves the problem and makes it work closer to what it should.</p>


	<p>The only point still valid is that IRRE doesn't consider <code>mergeIfNotBlank</code> at all.</p>


	<p>Example: If I add a category to a news record in the default language and localize the news record, the localized news records inherits the categories of the parent if I don't set any categories explicitely.</p>


	<p>In my opinion, a consistent behaviour would be that also attached IRRE records would be taken from the parent on localizing a record - as long as I don't select other IRRE records manually. But I'm aware that IRRE works differently and also has a different behaviour regarding localization.</p>


	<p>If the patch you in <a href="57272.html" class="issue status-6 priority-1" title="Extbase doesn't handle FAL translations correctly (Under Review)">#57272</a> is merged, this will make Extbase usable in a multi-language environment with e.g. News. The discussion about default behaviour can be held later.</p></div>
  </div>
  




</div>



<div style="clear: both;"></div>
<div class="contextual">


<span class="issue-59192-watcher"></span>


</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:
  <span><a href="../../external.html?link=https://forge.typo3.org/issues/59192.atom" class="atom" rel="nofollow">Atom</a></span>
  <span><a href="59192.pdf" class="pdf" rel="nofollow">PDF</a></span>
</p>







<script type="text/javascript">
//<![CDATA[
new ContextMenu('/issues/context_menu')
//]]>
</script>

        
				<div style="clear:both;"></div>
    </div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>
	
<div id="footer">
 Powered by <a href="../../external.html?link=http://www.redmine.org/">Redmine</a> &copy; 2006-2012 Jean-Philippe Lang<br /><br />
 Hosting sponsor:<br /><br />
 <script type="text/javascript">var buttonStyle = "footer-grey-31";</script>
 <script src="../../typo3.org/fileadmin/t3org/images/FM-content/team-pages/server-team/sponsor-banners/sponsors.js"></script>
</div>
</div>

<script type="text/javascript">
    var pkBaseURL = (("https:" == document.location.protocol) ? "https://piwik.typo3.org/" : "http://piwik.typo3.org/");
    document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
    try {
        var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 14);
        piwikTracker.trackPageView();
        piwikTracker.enableLinkTracking();
    } catch( err ) {}
</script>
<noscript><span style="visibility: hidden";><img src="../../external.html?link=http://piwik.typo3.org/piwik.php?idsite=14" style="border:0" alt=""/></span></noscript>
</body>

<!-- Mirrored from forge.typo3.org/issues/59192 by HTTrack Website Copier/3.x [XR&CO'2008], Mon, 03 Aug 2015 22:53:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
</html>
