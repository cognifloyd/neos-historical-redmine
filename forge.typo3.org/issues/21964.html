<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from forge.typo3.org/issues/21964 by HTTrack Website Copier/3.x [XR&CO'2008], Mon, 03 Aug 2015 23:03:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>Bug #21964: New child records created from a translated record have default language - Core - TYPO3 Forge</title>
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<link href="../themes/TYPO3/stylesheets/applicationfaba.css?1437165176" media="all" rel="stylesheet" type="text/css" />
<script src="../javascripts/prototypefaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/effectsfaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/dragdropfaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/controlsfaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/applicationfaba.js?1437165176" type="text/javascript"></script>
<script src="../plugin_assets/flow_design_helpers/javascripts/custom-scriptsf881.js?1437165331" type="text/javascript"></script>

<!--[if IE]>
    <style type="text/css">
      * html body{ width: expression( document.documentElement.clientWidth < 900 ? '900px' : '100%' ); }
      body {behavior: url(/stylesheets/csshover.htc?1437165176);}
    </style>
<![endif]-->
 <link href="../plugin_assets/redmine_backlogs/stylesheets/jquery/jquery.jqplot.minb674.css?1437165332" media="screen" rel="stylesheet" type="text/css" />

<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery-1.6.2.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery-ui-1.8.16.custom.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jeditable.minib674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.scrollfollowb674.js?1437165332" type="text/javascript"></script>

<!--[if IE]>
<script src="/plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/excanvas.js?1437165332" type="text/javascript"></script>
<![endif]-->
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/jquery.jqplotb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.highlighterb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.canvasTextRenderer.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.canvasAxisTickRenderer.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.enhancedLegendRenderer.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.cookieb674.js?1437165332" type="text/javascript"></script>

<script type="text/javascript"
        src="../rb/server_variables.js">
</script>
<script src="../plugin_assets/redmine_backlogs/javascripts/commonb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/burndownb674.js?1437165332" type="text/javascript"></script>


<style type="text/css">

</style>

<!-- page specific tags -->

    <link href="../../external.html?link=https://forge.typo3.org/issues/21964.atom" rel="alternate" title="Core - Bug #21964: New child records created from a translated record have default language" type="application/atom+xml" />
    <link href="../themes/TYPO3/stylesheets/scmfaba.css?1437165176" media="screen" rel="stylesheet" type="text/css" />
<script src="../javascripts/context_menufaba.js?1437165176" type="text/javascript"></script><link href="../stylesheets/context_menufaba.css?1437165176" media="screen" rel="stylesheet" type="text/css" /><script src="../javascripts/jstoolbar/jstoolbarfaba.js?1437165176" type="text/javascript"></script><script src="../javascripts/jstoolbar/textilefaba.js?1437165176" type="text/javascript"></script><script src="../javascripts/jstoolbar/lang/jstoolbar-enfaba.js?1437165176" type="text/javascript"></script><link href="../stylesheets/jstoolbarfaba.css?1437165176" media="screen" rel="stylesheet" type="text/css" /></head>
<body>
<div id="wrapper">
<div id="top-menu">
    <div id="account">
        <ul><li><a href="../../external.html?link=https://forge.typo3.org/login" class="login">Sign in</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/account/register" class="register">Register</a></li></ul>    </div>
    
    <ul><li><a href="../../external.html?link=https://forge.typo3.org/" class="home">Home</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects" class="projects">Projects</a></li>
<li><a href="../../external.html?link=http://www.redmine.org/guide" class="help">Help</a></li></ul></div>
      
<div id="header">
    <div id="header-left">
        <div id="header-menu">
            <a href="../../external.html?link=https://forge.typo3.org/" class="start">Start</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms" class="level-0 current sorting-10">TYPO3 CMS</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3neos" class="level-0 sorting-20">TYPO3 Neos</a><a href="../../external.html?link=https://forge.typo3.org/projects/flow3" class="level-0 sorting-20">TYPO3 Flow</a><a href="../../external.html?link=https://forge.typo3.org/projects/team-docteam" class="level-0 sorting-26">Documentation</a><a href="../../external.html?link=https://forge.typo3.org/projects/other" class="level-0 sorting-30">other</a>
        </div>
    </div>
    
    <div id="right-area"  style="">
        <div id="quick-search">
            <form action="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/search" method="get">
            <input name="issues" type="hidden" value="1" />
            <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/search" accesskey="4" style="">Search</a>:
            <input accesskey="f" class="small" id="q" name="q" size="20" type="text" />
            </form>
        </div>

        <h1>Core</h1>
        <div id="quicklinks"><p>Development of TYPO3 CMS</p></div>
    </div>
    
    <div id="main-menu">
        <input class="projectsearch placeholder" id="projectname_project" name="projectname[project]" onfocus="this.value = &quot;&quot;; $(this).removeClassName(&quot;placeholder&quot;);" size="30" type="text" value="Project title search" /><div class="auto_complete" id="projectname_project_auto_complete"></div><script type="text/javascript">
//<![CDATA[
var projectname_project_auto_completer = new Ajax.Autocompleter('projectname_project', 'projectname_project_auto_complete', '/projects/auto_complete', {afterUpdateElement:function(element, value) { var identNode = $(value).select(".identifier"); window.location.href="/projects/"+identNode[0].innerHTML }})
//]]>
</script>
        <ul><li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core" class="overview">Overview</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity" class="activity">Activity</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/roadmap" class="roadmap">Roadmap</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues" class="issues selected">Issues</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/wiki" class="wiki">Wiki</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/repository" class="repository">Repository</a></li></ul>
    </div>
</div>

<div class="" id="main">
    <div id="leftmenu">
        <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core" class="level-1 current sorting-10">Core</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3v4-search" class="level-2 sorting-0">Indexed Search</a><a href="../../external.html?link=https://forge.typo3.org/projects/extension-linkvalidator" class="level-2 sorting-0">Linkvalidator</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-releasecycles" class="level-2 sorting-0">Release Cycles</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-team" class="level-2 sorting-0">Team Resources</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3v4-workspaces" class="level-2 sorting-0">Workspaces & Versioning</a><a href="../../external.html?link=https://forge.typo3.org/projects/usability" class="level-2 sorting-10">TYPO3 CMS Usability Team</a><a href="../../external.html?link=https://forge.typo3.org/projects/extensions" class="level-1 sorting-20">Community Extensions</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3v4-distribution" class="level-1 sorting-44">Distributions</a><a href="../../external.html?link=https://forge.typo3.org/projects/cms-feature-requests" class="level-1 sorting-50">Feature-Requests</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-v62" class="level-1 sorting-620">TYPO3 6.2 Projects (+)</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-archived" class="level-1 sorting-1000">(Archived Projects)</a>
    </div>
    <div id="sidebar">        
        
  <h3>Issues</h3>
<a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?set_filter=1">View all issues</a><br />

<a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues/report">Summary</a><br />







<h3>Custom queries</h3><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=219" class="query">Easy tasks</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=391" class="query">FAL Issues</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=133" class="query">Hierarchical Issues</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=322" class="query">Most wanted Bugfixes</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=321" class="query">Most wanted Features</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=167" class="query">My open issues</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=203" class="query">New &amp; Unassigned</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=90" class="query">Open Bugs</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=204" class="query">Recently modified</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=523" class="query">Regressions</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=459" class="query">Roadmap v7</a>



  
    <div id="watchers">
      

<h3>Watchers (8)</h3>

<ul><li><a href="../../external.html?link=https://forge.typo3.org/users/123">Jochen Rau</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/639">Michael Voehringer</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/2045">Marcel Greter</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/2737">Andreas Kiessling</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/1175">Andreas Dörler</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/36475">Jan Greth</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/3883">Viktor Livakivskyi</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/35">Oliver Hader</a></li></ul>

    </div>
  

        
    </div>
    
    <div id="content">
				
        <div class="contextual">


<span class="issue-21964-watcher"></span>


</div>


<h2>Bug #21964</h2>

<div class="issue status-9 priority-2 closed details">
  

  

<div class="subject">
<div><h3>New child records created from a translated record have default language</h3></div>
</div>
        <p class="author">
        Added by <a href="../../external.html?link=https://forge.typo3.org/users/2045">Marcel Greter</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2010-01-15" title="2010-01-15 17:17">over 5 years</a> ago.
        
        Updated <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-07-10" title="2014-07-10 17:01">about 1 year</a> ago.
        
        </p>

<table class="attributes">
<tr>
    <th class="status">Status:</th><td class="status">Closed</td>
    <th class="start-date">Start date:</th><td class="start-date">2010-01-15</td>
</tr>
<tr>
    <th class="priority">Priority:</th><td class="priority">Should have</td>
    <th class="due-date">Due date:</th><td class="due-date"></td>
</tr>
<tr>
    <th class="assigned-to">Assigned To:</th><td class="assigned-to">-</td>
    <th class="progress">% Done:</th><td class="progress"><table class="progress" style="width: 80px;"><tr><td class="todo" style="width: 100%;"></td></tr></table><p class="pourcent">0%</p></td>
</tr>
<tr>
    <th class="category">Category:</th><td class="category">IRRE</td>
    
    <th class="spent-time">Spent time:</th>
    <td class="spent-time">-</td>
    
</tr>
<tr>
    <th class="fixed-version">Target version:</th><td class="fixed-version">-</td>
    
</tr>
<tr>
	<th>TYPO3 Version:</th><td>4.3</td>
	<th>Is Regression:</th><td>No</td>
</tr>
<tr>
	<th>PHP Version:</th><td>5.3</td>
	<th>Sprint Focus:</th><td></td>
</tr>
<tr>
	<th>Complexity:</th><td></td>
</tr>


</table>

<hr />

  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>You can find an example here: <a class="external" href="../../external.html?link=http://www.olly.de/typo3/irre_localization.html">http://www.olly.de/typo3/irre_localization.html</a> @ 2:20</p>


	<p>In the example a german hotel record is edited and the editor then creates a new offer. As you can see at 2:25 the new created offer has the language set to default. I myself use a intermediate table and the relation record also is created in default language. If I edit the relation record, the first item is an "invalid value (x)" (as it is looking for the id with default language, but in fact it is pointing to the record in german). If I set the child and relation record to german it is working as expected. IMO, l18n_parent could/should also be set.</p>


	<p>Marcel Greter</p>


	<p>(issue imported from #M13250)</p>
  </div>

<div class="attachments">

<p><a href="../../external.html?link=https://forge.typo3.org/attachments/download/13220/class.t3lib_tceforms_inline.php.patch" class="icon icon-attachment">class.t3lib_tceforms_inline.php.patch</a>  
    <a href="../../external.html?link=https://forge.typo3.org/attachments/13220/class.t3lib_tceforms_inline.php.patch"><img alt="Magnifier" src="../images/magnifierfaba.png?1437165176" /></a>
  
  
  <span class="size">(1.2 kB)</span>
  
  
    <span class="author">Administrator Admin, 2010-01-18 16:34</span>
  
  </p>

<p><a href="../../external.html?link=https://forge.typo3.org/attachments/download/13221/class.t3lib_tceforms_inline.php.v2.patch" class="icon icon-attachment">class.t3lib_tceforms_inline.php.v2.patch</a>  
    <a href="../../external.html?link=https://forge.typo3.org/attachments/13221/class.t3lib_tceforms_inline.php.v2.patch"><img alt="Magnifier" src="../images/magnifierfaba.png?1437165176" /></a>
  
  
  <span class="size">(1.5 kB)</span>
  
  
    <span class="author">Administrator Admin, 2010-04-20 17:09</span>
  
  </p>

</div>







<hr />
<div id="relations">
<div class="contextual">

</div>

<p><strong>Related issues</strong></p>


<form>
<table class="list issues">

<tr class="issue hascontextmenu" id="relation-10740">
<td class="checkbox"><input name="ids[]" type="checkbox" value="40656" /></td>
<td class="subject">related to 
    Core - 
    <a href="40656.html" class="issue status-7 priority-1 closed">Bug #40656</a>: t3lib_TCEforms_inline-&gt;createNewRecord doesn&#39;t create loc...
</td>
<td class="status">Resolved</td>
<td class="start_date">2012-09-05</td>
<td class="due_date"></td>
<td class="buttons"></td>
</tr>

<tr class="issue hascontextmenu" id="relation-11405">
<td class="checkbox"><input name="ids[]" type="checkbox" value="57063" /></td>
<td class="subject">duplicates 
    Core - 
    <a href="57063.html" class="issue status-7 priority-2 closed">Bug #57063</a>: Parent language is not applied to new child records
</td>
<td class="status">Resolved</td>
<td class="start_date">2014-03-19</td>
<td class="due_date"></td>
<td class="buttons"></td>
</tr>

<tr class="issue hascontextmenu" id="relation-10741">
<td class="checkbox"><input name="ids[]" type="checkbox" value="48883" /></td>
<td class="subject">blocks 
    Core - 
    <a href="48883.html" class="issue status-1 priority-2">Bug #48883</a>: Wrong sys_language_uid in sys_file_reference
</td>
<td class="status">New</td>
<td class="start_date">2013-06-05</td>
<td class="due_date"></td>
<td class="buttons"></td>
</tr>

</table>
</form>


<form action="../../external.html?link=https://forge.typo3.org/issues/21964/relations" id="new-relation-form" method="post" onsubmit="new Ajax.Request('/issues/21964/relations', {asynchronous:true, evalScripts:true, method:'post', onComplete:function(request){Form.Element.focus('relation_issue_to_id');}, parameters:Form.serialize(this)}); return false;" style="display: none;"><div style="margin:0;padding:0;display:inline"><input name="authenticity_token" type="hidden" value="IjgAk+sryuS7AAkPn7/ITUV652f6cwFBHN6GNTvW7o8=" /></div>


<p><select id="relation_relation_type" name="relation[relation_type]" onchange="setPredecessorFieldsVisibility();"><option value="relates">related to</option>
<option value="duplicates">duplicates</option>
<option value="duplicated">duplicated by</option>
<option value="blocks">blocks</option>
<option value="blocked">blocked by</option>
<option value="precedes">precedes</option>
<option value="follows">follows</option></select>
Issue #<input id="relation_issue_to_id" name="relation[issue_to_id]" size="10" type="text" />
<span id="predecessor_fields" style="display:none;">
Delay: <input id="relation_delay" name="relation[delay]" size="3" type="text" /> days
</span>
<input name="commit" type="submit" value="Add" />
<a href="#" onclick="Element.toggle('new-relation-form'); this.blur(); return false;">Cancel</a>
</p>

<div id="related_issue_candidates" class="autocomplete"></div>
<script type="text/javascript">
//<![CDATA[
observeRelatedIssueField('/issues/auto_complete?id=21964&amp;project_id=typo3cms-core')
//]]>
</script>

<script type="text/javascript">
//<![CDATA[
setPredecessorFieldsVisibility();
//]]>
</script>

</form>

</div>


</div>




<div id="history">
<h3>History</h3>

  <div id="change-55274" class="journal has-notes">
    <h4><a href="21964.html#note-1" class="journal-link">#1</a>
    
    <a name="note-1"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/2045">Marcel Greter</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2010-01-18" title="2010-01-18 09:40">over 5 years</a> ago</h4>

    
    <div class="wiki" id="journal-55274-notes"><p>Please forget about l18n_parent, it's of course "null" as there is no known parent. Also it's only affecting "create new" which we might can live without. Anyway, I guess it's still not making sense that clicking on "create new" on a german record creates records in default language.</p></div>
  </div>
  

  <div id="change-55275" class="journal has-notes">
    <h4><a href="21964.html#note-2" class="journal-link">#2</a>
    
    <a name="note-2"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/2045">Marcel Greter</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2010-01-18" title="2010-01-18 11:10">over 5 years</a> ago</h4>

    
    <div class="wiki" id="journal-55275-notes"><p>I found one bug so far :</p>


	<p>t3lib/class.t3lib_tceforms_inline.php @ 1139</p>


	<p>- if ($parentRecord[$languageField]>0) {<br />-     $record[$childLanguageField] = $parentRecord[$languageField];<br />- }</p>


	<p>+ if ($parentRecord[$parentLanguageField]>0) {<br />+     $record[$childLanguageField] = $parentRecord[$parentLanguageField];<br />+ }</p>


	<p>Now the newly created relation does inherit the language of the parent record, but the relation record still points to the same entry as the default language. IMO the referenced record should also be translated (copied) and the relation then should point to this new record.</p></div>
  </div>
  

  <div id="change-55276" class="journal has-notes">
    <h4><a href="21964.html#note-3" class="journal-link">#3</a>
    
    <a name="note-3"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/2045">Marcel Greter</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2010-01-18" title="2010-01-18 12:13">over 5 years</a> ago</h4>

    
    <div class="wiki" id="journal-55276-notes"><p>I guess this is a related bug : <a class="external" href="../../external.html?link=http://bugs.typo3.org/view.php?id=9526">http://bugs.typo3.org/view.php?id=9526</a></p>


	<p>I'm now looking into localizeChildrenAtParentLocalization, localizeReferencesAtParentLocalization and localizeReferences. It looks like it actually works now, will report back if I find any more problems.</p>


	<p>As a side note, irre expects the localizationMode parameter directly within config and not within behaviour. Irre tutorial always has it within behaviour, so I'm not sure what really was intended. This is at least the case in class.t3lib_tceforms_inline.php @ 1135</p>


	<p>if ($config['localizationMode']=='select')</p></div>
  </div>
  

  <div id="change-55277" class="journal has-notes">
    <h4><a href="21964.html#note-4" class="journal-link">#4</a>
    
    <a name="note-4"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/2045">Marcel Greter</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2010-01-18" title="2010-01-18 16:39">over 5 years</a> ago</h4>

    
    <div class="wiki" id="journal-55277-notes"><p>I attached a patch which does fix the "create new" link to behave as needed for my case.<br />If you click "create new" in combined edit mode, the new relation and the new record will be set to the language of the current record. IMO the patch is quite clean, but still use it at your own risk ;-)</p>


	<p>Hope it's helpfull!</p>


	<p>Best wishes,<br />Marcel Greter</p></div>
  </div>
  

  <div id="change-55278" class="journal has-notes">
    <h4><a href="21964.html#note-5" class="journal-link">#5</a>
    
    <a name="note-5"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/2737">Andreas Kiessling</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2010-05-11" title="2010-05-11 11:49">about 5 years</a> ago</h4>

    
    <div class="wiki" id="journal-55278-notes"><p>As i had struggled with irre and localization settings, i found this in core api:</p>


	<p>"localizationMode ('keep', 'select')<br />Defines in general whether children are really localizable (set to 'select') or just taken from the default language (set to 'keep'). If this property is not set, but the affected parent and child tables were localizable, the mode 'select' is used by default."</p>


	<p>So shouldn't the check look like this?<br />// Set language of new child record to the language of the parent record:<br />if (!isset($config['behaviour']['localizationMode']) || $config['behaviour']['localizationMode']=='select') {</p>


	<p>Regards,<br />Andreas</p></div>
  </div>
  

  <div id="change-95241" class="journal has-notes has-details">
    <h4><a href="21964.html#note-6" class="journal-link">#6</a>
    
    <a name="note-6"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/1175">Andreas Dörler</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2011-11-28" title="2011-11-28 14:52">over 3 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Target version</strong> deleted (<strike><i>0</i></strike>)</li>
      
    </ul>
    
    <div class="wiki" id="journal-95241-notes"><p>Hi,</p>


	<p>are there any current news to this issue?</p>


	<p>I see that a last part vo Marcel's patch (v2) seems to be already in the current core (4.5.7), but "if ($config['localizationMode'] == 'select')" is still wrong.</p>


	<p>In my case there is no need for "useCombination" but in my 1:n relation new child records are also created with default sys_language_uid instead of the current language.<br />I'm also wondering wheter it would be possible to remove the "create new records" button in any language than the default, but leave the records itself. This would solve (workaround) my issue, as new records could only be created in default language and localization of them works as expected.</p>


	<p>Kind regards,<br />Andreas</p></div>
  </div>
  

  <div id="change-154803" class="journal has-details">
    <h4><a href="21964.html#note-7" class="journal-link">#7</a>
    
    <a name="note-7"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/202">Stefan Galinski</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2013-03-15" title="2013-03-15 23:36">over 2 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Category</strong> set to <i>IRRE</i></li>
      
    </ul>
    
    
  </div>
  

  <div id="change-208718" class="journal has-notes">
    <h4><a href="21964.html#note-8" class="journal-link">#8</a>
    
    <a name="note-8"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/3883">Viktor Livakivskyi</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-03-18" title="2014-03-18 10:36">over 1 year</a> ago</h4>

    
    <div class="wiki" id="journal-208718-notes"><p>The issue is still in place with 6.x branch. But now it is even more critical, because developers are switching to Extbase, and wrong sys_language_uid at child record makes it impossible to get this child form parent - even by repository.</p>


	<p>This issue is partly related to <a href="40656.html" class="issue status-7 priority-1 closed" title="t3lib_TCEforms_inline-&gt;createNewRecord doesn't create localized records (Resolved)">#40656</a>, which I've reported over a year ago.<br />And fix for that issue is quite simple, but not enough. Because, even if InlineElement->createNewRecord() sets correct sys_language_uid to a child on creation, saving of a record again leads to sys_language_uid=0 for a child, which is worng and problem persists somewhere in BE DataMapper.</p></div>
  </div>
  

  <div id="change-209982" class="journal has-notes">
    <h4><a href="21964.html#note-9" class="journal-link">#9</a>
    
    <a name="note-9"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/36475">Jan Greth</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-03-24" title="2014-03-24 09:42">over 1 year</a> ago</h4>

    
    <div class="wiki" id="journal-209982-notes"><p>Can confirm this. I have the exact same behaviour and brings much trouble in multilingual sites...</p></div>
  </div>
  

  <div id="change-221024" class="journal has-notes has-details">
    <h4><a href="21964.html#note-10" class="journal-link">#10</a>
    
    <a name="note-10"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/40223">Teamgeist Medien</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-06-20" title="2014-06-20 13:58">about 1 year</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Target version</strong> set to <i>next-patchlevel</i></li>
      
    </ul>
    
    <div class="wiki" id="journal-221024-notes"><p>Having the same problem. This fix <a class="external" href="57063.html">http://forge.typo3.org/issues/57063</a> sets the language of newRecords to the parents language but when translating a tt_content element with flexform IRREs, the translated elements IRRE records are the same as the default ones.</p></div>
  </div>
  

  <div id="change-222024" class="journal has-notes">
    <h4><a href="21964.html#note-11" class="journal-link">#11</a>
    
    <a name="note-11"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/3883">Viktor Livakivskyi</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-06-27" title="2014-06-27 16:46">about 1 year</a> ago</h4>

    
    <div class="wiki" id="journal-222024-notes"><p><a href="57063.html" class="issue status-7 priority-2 closed" title="Parent language is not applied to new child records (Resolved)">#57063</a> is solved, which may lead to closing of this issue.<br />But there is still a case, when this issue is reproduced even after mentioned fix.<br />Whenever 'sys_language_uid' field is marked as 'readOnly' in config section, child record again becomes saved with sys_language_uid=0.</p>


	<p>This is a common behaviour, since there is no need to allow editors to change language of a localization.</p>


	<p>Tested under TYPO3 6.1</p>


	<p>EDIT: I was too blind to see the reason. If a field marked as 'readOnly' it is rendered with 'disabled' attribute in HTML, and therefore it's value is not sent to the server. Therefore DataMapper sets sys_language_uid to 0, since nothing comes in POST-request.<br />But anyway, in my opinioin, DataMapper needs to set explicitly sys_language_uid to value, taken from parent record, if it doesn't appear in POST and is defined as 'languageField' in 'ctrl' section of TCA.</p></div>
  </div>
  

  <div id="change-222336" class="journal has-notes has-details">
    <h4><a href="21964.html#note-12" class="journal-link">#12</a>
    
    <a name="note-12"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/50">Helmut Hummel</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-06-29" title="2014-06-29 17:52">about 1 year</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Status</strong> changed from <i>New</i> to <i>Needs Feedback</i></li>
      
       <li><strong>Is Regression</strong> set to <i>No</i></li>
      
    </ul>
    
    <div class="wiki" id="journal-222336-notes"><p>Viktor Livakivskyi wrote:</p>


<blockquote>

	<p><a href="57063.html" class="issue status-7 priority-2 closed" title="Parent language is not applied to new child records (Resolved)">#57063</a> is solved, which may lead to closing of this issue.</p>


</blockquote>

	<p>so we can close it?</p>


<blockquote>

	<p>But there is still a case, when this issue is reproduced even after mentioned fix.<br />Whenever 'sys_language_uid' field is marked as 'readOnly' in config section, child record again becomes saved with sys_language_uid=0.</p>


</blockquote>

	<p>As mentioned on the dev mailing list, this is a different story. Using readOnly for sys_language or l10n_parent fields lead to unexpected results.</p>


	<p>Tackling this would be a different issue.</p></div>
  </div>
  

  <div id="change-222469" class="journal has-notes">
    <h4><a href="21964.html#note-13" class="journal-link">#13</a>
    
    <a name="note-13"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/3883">Viktor Livakivskyi</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-07-01" title="2014-07-01 12:05">about 1 year</a> ago</h4>

    
    <div class="wiki" id="journal-222469-notes"><p>Hi, Helmut.</p>


<blockquote>

	<p>so we can close it?</p>


</blockquote>

	<p>Yes, becasue this issue is about non-'readOnly' scenario.</p>


<blockquote><blockquote>

	<p>But there is still a case, when this issue is reproduced even after mentioned fix.<br />Whenever 'sys_language_uid' field is marked as 'readOnly' in config section, child record again becomes saved with sys_language_uid=0.</p>


</blockquote>

	<p>As mentioned on the dev mailing list, this is a different story. Using readOnly for sys_language or l10n_parent fields lead to unexpected results.</p>


	<p>Tackling this would be a different issue.</p>


</blockquote>

	<p>I've just created a new feature request <a href="60026.html" class="issue status-1 priority-2" title="Set explicitly 'readOnly' sys_language_uid of child to value, taken from parent record (New)">#60026</a> for this. Feel free to update it with more info, if needed.</p></div>
  </div>
  

  <div id="change-223697" class="journal has-notes has-details">
    <h4><a href="21964.html#note-14" class="journal-link">#14</a>
    
    <a name="note-14"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/3767">Alexander Opitz</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-07-10" title="2014-07-10 17:01">about 1 year</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Status</strong> changed from <i>Needs Feedback</i> to <i>Closed</i></li>
      
       <li><strong>Target version</strong> deleted (<strike><i>next-patchlevel</i></strike>)</li>
      
    </ul>
    
    <div class="wiki" id="journal-223697-notes"><p>Closing as commented.</p>


	<p>Thanks for help.</p></div>
  </div>
  




</div>



<div style="clear: both;"></div>
<div class="contextual">


<span class="issue-21964-watcher"></span>


</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:
  <span><a href="../../external.html?link=https://forge.typo3.org/issues/21964.atom" class="atom" rel="nofollow">Atom</a></span>
  <span><a href="21964.pdf" class="pdf" rel="nofollow">PDF</a></span>
</p>







<script type="text/javascript">
//<![CDATA[
new ContextMenu('/issues/context_menu')
//]]>
</script>

        
				<div style="clear:both;"></div>
    </div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>
	
<div id="footer">
 Powered by <a href="../../external.html?link=http://www.redmine.org/">Redmine</a> &copy; 2006-2012 Jean-Philippe Lang<br /><br />
 Hosting sponsor:<br /><br />
 <script type="text/javascript">var buttonStyle = "footer-grey-31";</script>
 <script src="../../typo3.org/fileadmin/t3org/images/FM-content/team-pages/server-team/sponsor-banners/sponsors.js"></script>
</div>
</div>

<script type="text/javascript">
    var pkBaseURL = (("https:" == document.location.protocol) ? "https://piwik.typo3.org/" : "http://piwik.typo3.org/");
    document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
    try {
        var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 14);
        piwikTracker.trackPageView();
        piwikTracker.enableLinkTracking();
    } catch( err ) {}
</script>
<noscript><span style="visibility: hidden";><img src="../../external.html?link=http://piwik.typo3.org/piwik.php?idsite=14" style="border:0" alt=""/></span></noscript>
</body>

<!-- Mirrored from forge.typo3.org/issues/21964 by HTTrack Website Copier/3.x [XR&CO'2008], Mon, 03 Aug 2015 23:03:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
</html>
