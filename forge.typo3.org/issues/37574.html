<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from forge.typo3.org/issues/37574 by HTTrack Website Copier/3.x [XR&CO'2008], Mon, 03 Aug 2015 22:00:47 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>Bug #37574: ReflectionData is not regenerated automatically - TYPO3.Flow - TYPO3 Forge</title>
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<link href="../themes/TYPO3/stylesheets/applicationfaba.css?1437165176" media="all" rel="stylesheet" type="text/css" />
<script src="../javascripts/prototypefaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/effectsfaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/dragdropfaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/controlsfaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/applicationfaba.js?1437165176" type="text/javascript"></script>
<script src="../plugin_assets/flow_design_helpers/javascripts/custom-scriptsf881.js?1437165331" type="text/javascript"></script>

<!--[if IE]>
    <style type="text/css">
      * html body{ width: expression( document.documentElement.clientWidth < 900 ? '900px' : '100%' ); }
      body {behavior: url(/stylesheets/csshover.htc?1437165176);}
    </style>
<![endif]-->
 <link href="../plugin_assets/redmine_backlogs/stylesheets/jquery/jquery.jqplot.minb674.css?1437165332" media="screen" rel="stylesheet" type="text/css" />

<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery-1.6.2.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery-ui-1.8.16.custom.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jeditable.minib674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.scrollfollowb674.js?1437165332" type="text/javascript"></script>

<!--[if IE]>
<script src="/plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/excanvas.js?1437165332" type="text/javascript"></script>
<![endif]-->
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/jquery.jqplotb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.highlighterb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.canvasTextRenderer.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.canvasAxisTickRenderer.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.enhancedLegendRenderer.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.cookieb674.js?1437165332" type="text/javascript"></script>

<script type="text/javascript"
        src="../rb/server_variables.js">
</script>
<script src="../plugin_assets/redmine_backlogs/javascripts/commonb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/burndownb674.js?1437165332" type="text/javascript"></script>


<style type="text/css">

#header #right-area, #header #right-area h1, #header #right-area a {
  color:transparent;
}

</style>

<!-- page specific tags -->

    <link href="../../external.html?link=https://forge.typo3.org/issues/37574.atom" rel="alternate" title="TYPO3.Flow - Bug #37574: ReflectionData is not regenerated automatically" type="application/atom+xml" />
    <link href="../themes/TYPO3/stylesheets/scmfaba.css?1437165176" media="screen" rel="stylesheet" type="text/css" />
<script src="../javascripts/context_menufaba.js?1437165176" type="text/javascript"></script><link href="../stylesheets/context_menufaba.css?1437165176" media="screen" rel="stylesheet" type="text/css" /><script src="../javascripts/jstoolbar/jstoolbarfaba.js?1437165176" type="text/javascript"></script><script src="../javascripts/jstoolbar/textilefaba.js?1437165176" type="text/javascript"></script><script src="../javascripts/jstoolbar/lang/jstoolbar-enfaba.js?1437165176" type="text/javascript"></script><link href="../stylesheets/jstoolbarfaba.css?1437165176" media="screen" rel="stylesheet" type="text/css" /></head>
<body>
<div id="wrapper">
<div id="top-menu">
    <div id="account">
        <ul><li><a href="../../external.html?link=https://forge.typo3.org/login" class="login">Sign in</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/account/register" class="register">Register</a></li></ul>    </div>
    
    <ul><li><a href="../../external.html?link=https://forge.typo3.org/" class="home">Home</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects" class="projects">Projects</a></li>
<li><a href="../../external.html?link=http://www.redmine.org/guide" class="help">Help</a></li></ul></div>
      
<div id="header">
    <div id="header-left">
        <div id="header-menu">
            <a href="../../external.html?link=https://forge.typo3.org/" class="start">Start</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms" class="level-0 sorting-10">TYPO3 CMS</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3neos" class="level-0 sorting-20">TYPO3 Neos</a><a href="../../external.html?link=https://forge.typo3.org/projects/flow3" class="level-0 current sorting-20">TYPO3 Flow</a><a href="../../external.html?link=https://forge.typo3.org/projects/team-docteam" class="level-0 sorting-26">Documentation</a><a href="../../external.html?link=https://forge.typo3.org/projects/other" class="level-0 sorting-30">other</a>
        </div>
    </div>
    
    <div id="right-area"  style="background-image:url(../headerimages/16.jpg);">
        <div id="quick-search">
            <form action="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/search" method="get">
            <input name="issues" type="hidden" value="1" />
            <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/search" accesskey="4" style="color:transparent">Search</a>:
            <input accesskey="f" class="small" id="q" name="q" size="20" type="text" />
            </form>
        </div>

        <h1>TYPO3.Flow</h1>
        <div id="quicklinks"></div>
    </div>
    
    <div id="main-menu">
        <input class="projectsearch placeholder" id="projectname_project" name="projectname[project]" onfocus="this.value = &quot;&quot;; $(this).removeClassName(&quot;placeholder&quot;);" size="30" type="text" value="Project title search" /><div class="auto_complete" id="projectname_project_auto_complete"></div><script type="text/javascript">
//<![CDATA[
var projectname_project_auto_completer = new Ajax.Autocompleter('projectname_project', 'projectname_project_auto_complete', '/projects/auto_complete', {afterUpdateElement:function(element, value) { var identNode = $(value).select(".identifier"); window.location.href="/projects/"+identNode[0].innerHTML }})
//]]>
</script>
        <ul><li><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow" class="overview">Overview</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity" class="activity">Activity</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/roadmap" class="roadmap">Roadmap</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/issues" class="issues selected">Issues</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/repository" class="repository">Repository</a></li></ul>
    </div>
</div>

<div class="" id="main">
    <div id="leftmenu">
        <a href="../../external.html?link=https://forge.typo3.org/projects/flow3-distribution-base" class="level-1 current sorting-0">TYPO3 Flow Base Distribution</a><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-eel" class="level-2 sorting-0">TYPO3.Eel</a><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow" class="level-2 current sorting-0">TYPO3.Flow</a><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-fluid" class="level-2 sorting-0">TYPO3.Fluid</a><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-kickstart" class="level-2 sorting-0">TYPO3.Kickstart</a><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-welcome" class="level-2 sorting-0">TYPO3.Welcome</a><a href="../../external.html?link=https://forge.typo3.org/projects/packages" class="level-1 sorting-10">Packages</a><a href="../../external.html?link=https://forge.typo3.org/projects/flow3-apps" class="level-1 sorting-30">Applications</a>
    </div>
    <div id="sidebar">        
        
  <h3>Issues</h3>
<a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/issues?set_filter=1">View all issues</a><br />

<a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/issues/report">Summary</a><br />







<h3>Custom queries</h3><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/issues?query_id=133" class="query">Hierarchical Issues</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/issues?query_id=322" class="query">Most wanted Bugfixes</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/issues?query_id=321" class="query">Most wanted Features</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/issues?query_id=167" class="query">My open issues</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/issues?query_id=203" class="query">New &amp; Unassigned</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/issues?query_id=90" class="query">Open Bugs</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/issues?query_id=375" class="query">Open documentation issues</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/issues?query_id=204" class="query">Recently modified</a>



  
    <div id="watchers">
      

<h3>Watchers (1)</h3>

<ul><li><a href="../../external.html?link=https://forge.typo3.org/users/10">Karsten Dambekalns</a></li></ul>

    </div>
  

        
    </div>
    
    <div id="content">
				
        <div class="contextual">


<span class="issue-37574-watcher"></span>


</div>


<h2>Bug #37574</h2>

<div class="issue status-7 priority-4 closed parent details">
  

  

<div class="subject">
<div><h3>ReflectionData is not regenerated automatically</h3></div>
</div>
        <p class="author">
        Added by <a href="../../external.html?link=https://forge.typo3.org/users/61">Bastian Waidelich</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-05-29" title="2012-05-29 17:09">about 3 years</a> ago.
        
        Updated <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-08-17" title="2012-08-17 11:35">almost 3 years</a> ago.
        
        </p>

<table class="attributes">
<tr>
    <th class="status">Status:</th><td class="status">Resolved</td>
    <th class="start-date">Start date:</th><td class="start-date">2012-07-26</td>
</tr>
<tr>
    <th class="priority">Priority:</th><td class="priority">Won&#39;t have this time</td>
    <th class="due-date">Due date:</th><td class="due-date"></td>
</tr>
<tr>
    <th class="assigned-to">Assigned To:</th><td class="assigned-to"><a href="../../external.html?link=https://forge.typo3.org/users/10">Karsten Dambekalns</a></td>
    <th class="progress">% Done:</th><td class="progress"><table class="progress" style="width: 80px;"><tr><td class="closed" style="width: 100%;"></td></tr></table><p class="pourcent">100%</p></td>
</tr>
<tr>
    <th class="category">Category:</th><td class="category">Reflection</td>
    
    <th></th>
    <td></td>
    
</tr>
<tr>
    <th class="fixed-version">Target version:</th><td class="fixed-version"><a href="../../external.html?link=https://forge.typo3.org/versions/1839">TYPO3 Flow Base Distribution - 1.1 RC2</a></td>
    
</tr>
<tr>
	<th>PHP Version:</th><td>5.3</td>
	<th>Complexity:</th><td>nightmare</td>
</tr>
<tr>
	<th>Has patch:</th><td>No</td>
	<th>Affected Flow version:</th><td>FLOW3 1.1.0 beta 2</td>
</tr>


</table>

<hr />

  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>If the signature of an action changes in a controller or I add a @FLOW3\Inject annotation I would expect the Controllers reflection data to be recreated in Development context. But that's not the case (even if the FLOW3 package and my custom package are not frozen).</p>
  </div>






<hr />
<div id="issue_tree">
<div class="contextual">
  
</div>
<p><strong>Subtasks</strong></p>
<form><table class="list issues"><tr class="issue issue-39300 hascontextmenu "><td class="checkbox"><input name="ids[]" type="checkbox" value="39300" /></td><td class="subject"><a href="39300.html" class="issue status-9 priority-4 closed child">Bug #39300</a>: blocking ReflectionService: Call to a member function get...</td><td>Closed</td><td></td><td><table class="progress" style="width: 80px;"><tr><td class="todo" style="width: 100%;"></td></tr></table><p class="pourcent"></p></td></tr></table></form>
</div>



<hr />
<div id="relations">
<div class="contextual">

</div>

<p><strong>Related issues</strong></p>


<form>
<table class="list issues">

<tr class="issue hascontextmenu" id="relation-6529">
<td class="checkbox"><input name="ids[]" type="checkbox" value="37223" /></td>
<td class="subject">related to 
    TYPO3.Flow - 
    <a href="37223.html" class="issue status-7 priority-1 closed">Bug #37223</a>: Packages can be frozen in Production Context
</td>
<td class="status">Resolved</td>
<td class="start_date">2012-05-16</td>
<td class="due_date"></td>
<td class="buttons"></td>
</tr>

<tr class="issue hascontextmenu" id="relation-6531">
<td class="checkbox"><input name="ids[]" type="checkbox" value="37726" /></td>
<td class="subject">related to 
    TYPO3.Flow - 
    <a href="37726.html" class="issue status-7 priority-2 closed">Task #37726</a>: Packages should not be frozen by default
</td>
<td class="status">Resolved</td>
<td class="start_date">2012-06-04</td>
<td class="due_date"></td>
<td class="buttons"></td>
</tr>

<tr class="issue hascontextmenu" id="relation-6629">
<td class="checkbox"><input name="ids[]" type="checkbox" value="37815" /></td>
<td class="subject">related to 
    TYPO3.Flow - 
    <a href="37815.html" class="issue status-9 priority-1 closed">Bug #37815</a>: Object are not persisted
</td>
<td class="status">Closed</td>
<td class="start_date">2012-06-07</td>
<td class="due_date"></td>
<td class="buttons"></td>
</tr>

</table>
</form>


<form action="../../external.html?link=https://forge.typo3.org/issues/37574/relations" id="new-relation-form" method="post" onsubmit="new Ajax.Request('/issues/37574/relations', {asynchronous:true, evalScripts:true, method:'post', onComplete:function(request){Form.Element.focus('relation_issue_to_id');}, parameters:Form.serialize(this)}); return false;" style="display: none;"><div style="margin:0;padding:0;display:inline"><input name="authenticity_token" type="hidden" value="IjgAk+sryuS7AAkPn7/ITUV652f6cwFBHN6GNTvW7o8=" /></div>


<p><select id="relation_relation_type" name="relation[relation_type]" onchange="setPredecessorFieldsVisibility();"><option value="relates">related to</option>
<option value="duplicates">duplicates</option>
<option value="duplicated">duplicated by</option>
<option value="blocks">blocks</option>
<option value="blocked">blocked by</option>
<option value="precedes">precedes</option>
<option value="follows">follows</option></select>
Issue #<input id="relation_issue_to_id" name="relation[issue_to_id]" size="10" type="text" />
<span id="predecessor_fields" style="display:none;">
Delay: <input id="relation_delay" name="relation[delay]" size="3" type="text" /> days
</span>
<input name="commit" type="submit" value="Add" />
<a href="#" onclick="Element.toggle('new-relation-form'); this.blur(); return false;">Cancel</a>
</p>

<div id="related_issue_candidates" class="autocomplete"></div>
<script type="text/javascript">
//<![CDATA[
observeRelatedIssueField('/issues/auto_complete?id=37574&amp;project_id=package-typo3-flow')
//]]>
</script>

<script type="text/javascript">
//<![CDATA[
setPredecessorFieldsVisibility();
//]]>
</script>

</form>

</div>


</div>


<div id="issue-changesets">
<h3>Associated revisions</h3>

    <div class="changeset odd">
    <p><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/repository/revisions/d57781ab6fc326571d14c7722b472623797c6cf3" title="Revision d57781ab">Revision d57781ab</a><br />
        <span class="author">Added by <a href="../../external.html?link=https://forge.typo3.org/users/10">Karsten Dambekalns</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-07-09" title="2012-07-09 15:06">about 3 years</a> ago</span></p>
    <div class="wiki">
        <p>[TASK] Clean up some code</p>


	<p>Fixes some comments, style issues and API usage.</p>


	<p>Change-Id: I124c211ea218f8ffcad791bcc9eca2403f10b55f<br />Related: <a href="37574.html" class="issue status-7 priority-4 closed parent" title="ReflectionData is not regenerated automatically (Resolved)">#37574</a><br />Related: <a href="34875.html" class="issue status-7 priority-2 closed" title="Clean up code (style) (Resolved)">#34875</a><br />Releases: 1.1, 1.2</p>
    </div>
    </div>

    <div class="changeset even">
    <p><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/repository/revisions/8e393d38794c3da3201562dede34649215a99626" title="Revision 8e393d38">Revision 8e393d38</a><br />
        <span class="author">Added by <a href="../../external.html?link=https://forge.typo3.org/users/10">Karsten Dambekalns</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-07-10" title="2012-07-10 12:34">about 3 years</a> ago</span></p>
    <div class="wiki">
        <p>[TASK] Clean up some code</p>


	<p>Fixes some comments, style issues and API usage.</p>


	<p>Change-Id: I124c211ea218f8ffcad791bcc9eca2403f10b55f<br />Related: <a href="37574.html" class="issue status-7 priority-4 closed parent" title="ReflectionData is not regenerated automatically (Resolved)">#37574</a><br />Related: <a href="34875.html" class="issue status-7 priority-2 closed" title="Clean up code (style) (Resolved)">#34875</a><br />Releases: 1.1, 1.2</p>
    </div>
    </div>

    <div class="changeset odd">
    <p><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/repository/revisions/d35532647cd6c6279ff1c5e7cc9123371778c1f1" title="Revision d3553264">Revision d3553264</a><br />
        <span class="author">Added by <a href="../../external.html?link=https://forge.typo3.org/users/10">Karsten Dambekalns</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-07-13" title="2012-07-13 17:15">about 3 years</a> ago</span></p>
    <div class="wiki">
        <p>[BUGFIX] Fix order of monitoring and proxy building</p>


	<p>During bootstrap file monitoring would be run too late,<br />so that while change detection worked fine, the results<br />were not used correctly: Reflection data was updated,<br />but that happened after DI proxy building, so that e.g.<br />added Inject annotations would not have the expected<br />effect.</p>


	<p>This change moves file monitoring before reflection<br />initialization to fix this.</p>


	<p>Change-Id: I4a16257d072e1eef99cf48bd60bf83f8818f0e1d<br />Fixes: <a href="37574.html" class="issue status-7 priority-4 closed parent" title="ReflectionData is not regenerated automatically (Resolved)">#37574</a><br />Releases: 1.1, 1.2</p>
    </div>
    </div>

    <div class="changeset even">
    <p><a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/repository/revisions/2b09113f409dc67c756c60fd6cf19ca1032c252e" title="Revision 2b09113f">Revision 2b09113f</a><br />
        <span class="author">Added by <a href="../../external.html?link=https://forge.typo3.org/users/10">Karsten Dambekalns</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-07-16" title="2012-07-16 13:02">about 3 years</a> ago</span></p>
    <div class="wiki">
        <p>[BUGFIX] Fix order of monitoring and proxy building</p>


	<p>During bootstrap file monitoring would be run too late,<br />so that while change detection worked fine, the results<br />were not used correctly: Reflection data was updated,<br />but that happened after DI proxy building, so that e.g.<br />added Inject annotations would not have the expected<br />effect.</p>


	<p>This change moves file monitoring before reflection<br />initialization to fix this.</p>


	<p>Change-Id: I4a16257d072e1eef99cf48bd60bf83f8818f0e1d<br />Fixes: <a href="37574.html" class="issue status-7 priority-4 closed parent" title="ReflectionData is not regenerated automatically (Resolved)">#37574</a><br />Releases: 1.1, 1.2</p>
    </div>
    </div>


</div>



<div id="history">
<h3>History</h3>

  <div id="change-118713" class="journal has-notes has-details">
    <h4><a href="37574.html#note-1" class="journal-link">#1</a>
    
    <a name="note-1"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/8">Robert Lemke</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-06-01" title="2012-06-01 08:56">about 3 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Category</strong> set to <i>Reflection</i></li>
      
       <li><strong>Priority</strong> changed from <i>Should have</i> to <i>Must have</i></li>
      
       <li><strong>PHP Version</strong> set to <i>5.3</i></li>
      
       <li><strong>Complexity</strong> set to <i>medium</i></li>
      
       <li><strong>Affected Flow version</strong> changed from <i>Git master</i> to <i>FLOW3 1.1.0 beta 2</i></li>
      
    </ul>
    
    <div class="wiki" id="journal-118713-notes"><p>This has some more severe consequences:</p>


	<ul>
	<li>freshly clone a FLOW3 distribution</li>
		<li>set file permissions and database settings</li>
		<li>./flow3 doctrine:migrate</li>
		<li>./flow3 kickstart:actioncontroller --generate-actions --generate-templates --generate-related Shop Book</li>
		<li>create a new Book through the form </li>
		<li>the message says that a new book was created but it's not persisted! No errors in log!</li>
		<li>./flow3 package:refreeze</li>
		<li>now it works!</li>
	</ul>


	<p>So, as a workaround - until this bug is fixed - make sure that all packages are unfrozen (./flow3 package:unfreeze all)</p></div>
  </div>
  

  <div id="change-118714" class="journal has-notes">
    <h4><a href="37574.html#note-2" class="journal-link">#2</a>
    
    <a name="note-2"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/10">Karsten Dambekalns</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-06-01" title="2012-06-01 08:59">about 3 years</a> ago</h4>

    
    <div class="wiki" id="journal-118714-notes"><p>Packages should not be frozen by default, that way you'd need to learn about them before you can fall into any traps.</p></div>
  </div>
  

  <div id="change-118834" class="journal has-notes">
    <h4><a href="37574.html#note-3" class="journal-link">#3</a>
    
    <a name="note-3"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/61">Bastian Waidelich</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-06-02" title="2012-06-02 12:36">about 3 years</a> ago</h4>

    
    <div class="wiki" id="journal-118834-notes"><p>Karsten Dambekalns wrote:</p>


<blockquote>

	<p>Packages should not be frozen by default</p>


</blockquote>

	<p>They are not, but the issue occurs even if the package is <strong>not frozen</strong> (see description above)</p></div>
  </div>
  

  <div id="change-118911" class="journal has-details">
    <h4><a href="37574.html#note-4" class="journal-link">#4</a>
    
    <a name="note-4"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/10">Karsten Dambekalns</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-06-04" title="2012-06-04 11:40">about 3 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Status</strong> changed from <i>New</i> to <i>Accepted</i></li>
      
       <li><strong>Assigned To</strong> set to <i>Karsten Dambekalns</i></li>
      
    </ul>
    
    
  </div>
  

  <div id="change-118918" class="journal has-notes">
    <h4><a href="37574.html#note-5" class="journal-link">#5</a>
    
    <a name="note-5"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/10">Karsten Dambekalns</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-06-04" title="2012-06-04 12:36">about 3 years</a> ago</h4>

    
    <div class="wiki" id="journal-118918-notes"><p>Bastian Waidelich wrote:</p>


<blockquote>

	<p>Karsten Dambekalns wrote:</p>


<blockquote>

	<p>Packages should not be frozen by default</p>


</blockquote>

	<p>They are not, but the issue occurs even if the package is <strong>not frozen</strong> (see description above)</p>


</blockquote>

	<p>Yes. The note was more a braindump, see <a href="37726.html" class="issue status-7 priority-2 closed" title="Packages should not be frozen by default (Resolved)">#37726</a> for the separate issue.</p></div>
  </div>
  

  <div id="change-118922" class="journal has-notes">
    <h4><a href="37574.html#note-6" class="journal-link">#6</a>
    
    <a name="note-6"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/10">Karsten Dambekalns</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-06-04" title="2012-06-04 14:17">about 3 years</a> ago</h4>

    
    <div class="wiki" id="journal-118922-notes"><p>Robert Lemke wrote:<br /> …</p>


<blockquote>

	<ul>
	<li>the message says that a new book was created but it's not persisted! No errors in log!</li>
	</ul>


</blockquote>

	<p>With the current 1.1 codebase that works fine for me.</p></div>
  </div>
  

  <div id="change-118934" class="journal has-notes">
    <h4><a href="37574.html#note-7" class="journal-link">#7</a>
    
    <a name="note-7"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/61">Bastian Waidelich</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-06-04" title="2012-06-04 18:18">about 3 years</a> ago</h4>

    
    <div class="wiki" id="journal-118934-notes"><p>While playing around with this a bit further, I made following observation:<br />Adding a new property with <code>@FLOW3\Inject</code> annotation <strong>does</strong> work sometimes.<br />Sometimes it doesn't but then - after changing something else in the same class - it does work suddenly.<br />My theory is, that the ModificationTimeStrategy doesn't work correctly. Maybe it compares the modification times with the time <strong>after</strong> the proxy classes have been built last, not with the time <strong>before</strong> they have been built?<br />I didn't check this, just a theory ;)</p></div>
  </div>
  

  <div id="change-118935" class="journal has-notes">
    <h4><a href="37574.html#note-8" class="journal-link">#8</a>
    
    <a name="note-8"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/61">Bastian Waidelich</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-06-04" title="2012-06-04 18:31">about 3 years</a> ago</h4>

    
    <div class="wiki" id="journal-118935-notes"><p>Bastian Waidelich wrote:</p>


<blockquote>

	<p>Maybe it compares the modification times with the time <strong>after</strong> the<br />proxy classes have been built last, not with the time <strong>before</strong> they have been built?</p>


</blockquote>

	<p>It does not compare the modification times in fact. But the issue might be, that the modificationTimes are stored in the cache while the files are changed or something. If I wait long enough <strong>before</strong> and <strong>after</strong> I do one single change, it seems to work.</p></div>
  </div>
  

  <div id="change-118938" class="journal has-notes">
    <h4><a href="37574.html#note-9" class="journal-link">#9</a>
    
    <a name="note-9"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/10">Karsten Dambekalns</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-06-04" title="2012-06-04 21:26">about 3 years</a> ago</h4>

    
    <div class="wiki" id="journal-118938-notes"><p>No, looking at the logs the file is always detected as modified, just the effect of that varies. YMMV.</p></div>
  </div>
  

  <div id="change-118979" class="journal has-notes">
    <h4><a href="37574.html#note-10" class="journal-link">#10</a>
    
    <a name="note-10"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/61">Bastian Waidelich</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-06-05" title="2012-06-05 14:08">about 3 years</a> ago</h4>

    
    <div class="wiki" id="journal-118979-notes"><p>Karsten Dambekalns wrote:</p>


<blockquote>

	<p>No, looking at the logs the file is always detected as modified<br />just the effect of that varies. YMMV.</p>


</blockquote>

	<p>Mh, then it's probably some kind of race condition still.. I experience a related issue lately:<br />If I modify a controller and hit refresh too soon, I get following error:<br /><pre>
Runtime Notice: Declaration of My\Package\Controller\Project\SomeController::initializeView() should be compatible with that of My\Package\Controller\Project\SomeController_Original::initializeView()
</pre></p>


	<p>Somehow the site is not locked correctly or so!? (sorry for the wild guesses, but maybe it helps anyways)</p></div>
  </div>
  

  <div id="change-121432" class="journal has-details">
    <h4><a href="37574.html#note-11" class="journal-link">#11</a>
    
    <a name="note-11"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/10">Karsten Dambekalns</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-06-26" title="2012-06-26 12:23">about 3 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Complexity</strong> changed from <i>medium</i> to <i>nightmare</i></li>
      
    </ul>
    
    
  </div>
  

  <div id="change-121506" class="journal has-notes">
    <h4><a href="37574.html#note-12" class="journal-link">#12</a>
    
    <a name="note-12"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/10">Karsten Dambekalns</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-06-26" title="2012-06-26 17:39">about 3 years</a> ago</h4>

    
    <div class="wiki" id="journal-121506-notes"><p>Ok, after adding some debugging instruments, a picture forms. The following is a log of what happens after a change to a controller. That change was the addition of <code>FLOW3\Inject</code> to the already existing property <code>$objectManagerInstance</code>.</p>


	<p>The first run picks up the change to the file and triggers rebuilding the DI proxy:<br /><pre>
12-06-26 17:33:05 17933 DEBUG FLOW3  runtime-typo3.flow3:errorhandling
12-06-26 17:33:05 17933 DEBUG FLOW3  runtime-typo3.flow3:cachemanagement
12-06-26 17:33:05 17933 DEBUG FLOW3  runtime-typo3.flow3:objectmanagement:proxyclasses

12-06-26 17:33:05 17934 DEBUG FLOW3  compiletime-typo3.flow3:errorhandling
12-06-26 17:33:05 17934 DEBUG FLOW3  compiletime-typo3.flow3:cachemanagement
12-06-26 17:33:05 17934 DEBUG FLOW3  compiletime-typo3.flow3:cachemanagement:forceflush
12-06-26 17:33:05 17934 DEBUG FLOW3  compiletime-typo3.flow3:objectmanagement:compiletime:create
12-06-26 17:33:05 17934 DEBUG FLOW3  compiletime-typo3.flow3:reflectionservice
12-06-26 17:33:05 17934 DEBUG FLOW3  compiletime-typo3.flow3:objectmanagement:compiletime:finalize
12-06-26 17:33:06 17934 DEBUG FLOW3  compiletime-typo3.flow3:systemfilemonitor
12-06-26 17:33:06 17934 INFO  FLOW3  File Monitor "FLOW3_ClassFiles" detected 1 changed files and 0 changed directories.
12-06-26 17:33:06 17934 INFO  FLOW3  Buidling DI proxy for "TYPO3\Welcome\Controller\StandardController".

12-06-26 17:33:06 17933 DEBUG FLOW3  runtime-typo3.flow3:classloader:cache
12-06-26 17:33:06 17933 DEBUG FLOW3  runtime-typo3.flow3:reflectionservice
12-06-26 17:33:06 17933 DEBUG FLOW3  runtime-typo3.flow3:objectmanagement:runtime
12-06-26 17:33:06 17933 DEBUG FLOW3  runtime-typo3.flow3:persistence
12-06-26 17:33:06 17933 DEBUG FLOW3  runtime-typo3.flow3:session
12-06-26 17:33:06 17933 DEBUG FLOW3  runtime-typo3.flow3:resources
12-06-26 17:33:06 17933 DEBUG FLOW3  runtime-typo3.flow3:i18n
</pre></p>


	<p>At this point the rebuilt proxy does <strong>not</strong> include injector code for the <code>$objectManagerInstance</code>! This is because only during the second run the ReflectionService picks up the change and learns about the new annotation:<br /><pre>
12-06-26 17:33:34 17971 DEBUG FLOW3  runtime-typo3.flow3:errorhandling
12-06-26 17:33:34 17971 DEBUG FLOW3  runtime-typo3.flow3:cachemanagement
12-06-26 17:33:34 17971 DEBUG FLOW3  runtime-typo3.flow3:objectmanagement:proxyclasses

12-06-26 17:33:34 17972 DEBUG FLOW3  compiletime-typo3.flow3:errorhandling
12-06-26 17:33:34 17972 DEBUG FLOW3  compiletime-typo3.flow3:cachemanagement
12-06-26 17:33:34 17972 DEBUG FLOW3  compiletime-typo3.flow3:cachemanagement:forceflush
12-06-26 17:33:34 17972 DEBUG FLOW3  compiletime-typo3.flow3:objectmanagement:compiletime:create
12-06-26 17:33:34 17972 DEBUG FLOW3  compiletime-typo3.flow3:reflectionservice
12-06-26 17:33:34 17972 DEBUG FLOW3  compiletime-typo3.flow3:objectmanagement:compiletime:finalize
12-06-26 17:33:34 17972 DEBUG FLOW3  Forget class TYPO3\Welcome\Controller\StandardController
12-06-26 17:33:34 17972 DEBUG FLOW3  Reflected class names did not match class names to reflect
12-06-26 17:33:34 17972 DEBUG FLOW3  Reflecting class TYPO3\Welcome\Controller\StandardController
12-06-26 17:33:34 17972 INFO  FLOW3  Reflected 1 emerged classes.
12-06-26 17:33:35 17972 DEBUG FLOW3  compiletime-typo3.flow3:systemfilemonitor
12-06-26 17:33:35 17972 DEBUG FLOW3  Found 1 classes whose reflection data was not cached previously.

12-06-26 17:33:35 17971 DEBUG FLOW3  runtime-typo3.flow3:classloader:cache
12-06-26 17:33:35 17971 DEBUG FLOW3  runtime-typo3.flow3:reflectionservice
12-06-26 17:33:35 17971 DEBUG FLOW3  runtime-typo3.flow3:objectmanagement:runtime
12-06-26 17:33:35 17971 DEBUG FLOW3  runtime-typo3.flow3:persistence
12-06-26 17:33:35 17971 DEBUG FLOW3  runtime-typo3.flow3:session
12-06-26 17:33:35 17971 DEBUG FLOW3  runtime-typo3.flow3:resources
12-06-26 17:33:35 17971 DEBUG FLOW3  runtime-typo3.flow3:i18n
</pre><br />At this point the proxy would be built correctly, but the system considers it up-to-date already.</p>


	<p>If now something else is changed in that file, the proxy will be rebuilt with the new reflection data and will be correct. Depending on the nature of that second change, the proxy will still be out of date though…</p></div>
  </div>
  

  <div id="change-121580" class="journal has-details">
    <h4><a href="37574.html#note-13" class="journal-link">#13</a>
    
    <a name="note-13"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/10">Karsten Dambekalns</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-06-27" title="2012-06-27 15:50">about 3 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Target version</strong> changed from <i>1.1 RC1</i> to <i>1.1</i></li>
      
    </ul>
    
    
  </div>
  

  <div id="change-122331" class="journal has-notes has-details">
    <h4><a href="37574.html#note-14" class="journal-link">#14</a>
    
    <a name="note-14"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/36798">Gerrit Code Review</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-07-04" title="2012-07-04 09:58">about 3 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Status</strong> changed from <i>Accepted</i> to <i>Under Review</i></li>
      
    </ul>
    
    <div class="wiki" id="journal-122331-notes"><p>Patch set 1 for branch <strong>master</strong> has been pushed to the review server.<br />It is available at <a class="external" href="../../external.html?link=http://review.typo3.org/12575">http://review.typo3.org/12575</a></p></div>
  </div>
  

  <div id="change-123808" class="journal has-notes">
    <h4><a href="37574.html#note-15" class="journal-link">#15</a>
    
    <a name="note-15"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/36798">Gerrit Code Review</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-07-13" title="2012-07-13 17:17">about 3 years</a> ago</h4>

    
    <div class="wiki" id="journal-123808-notes"><p>Patch set 2 for branch <strong>master</strong> has been pushed to the review server.<br />It is available at <a class="external" href="../../external.html?link=http://review.typo3.org/12575">http://review.typo3.org/12575</a></p></div>
  </div>
  

  <div id="change-123810" class="journal has-notes has-details">
    <h4><a href="37574.html#note-16" class="journal-link">#16</a>
    
    <a name="note-16"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/10">Karsten Dambekalns</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-07-13" title="2012-07-13 17:35">about 3 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Status</strong> changed from <i>Under Review</i> to <i>Resolved</i></li>
      
       <li><strong>% Done</strong> changed from <i>0</i> to <i>100</i></li>
      
    </ul>
    
    <div class="wiki" id="journal-123810-notes"><p>Applied in changeset <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/repository/revisions/d35532647cd6c6279ff1c5e7cc9123371778c1f1" class="changeset" title="[BUGFIX] Fix order of monitoring and proxy building During bootstrap file monitoring would be ru...">d35532647cd6c6279ff1c5e7cc9123371778c1f1</a>.</p></div>
  </div>
  

  <div id="change-124014" class="journal has-notes has-details">
    <h4><a href="37574.html#note-17" class="journal-link">#17</a>
    
    <a name="note-17"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/36798">Gerrit Code Review</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-07-16" title="2012-07-16 13:02">about 3 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Status</strong> changed from <i>Resolved</i> to <i>Under Review</i></li>
      
    </ul>
    
    <div class="wiki" id="journal-124014-notes"><p>Patch set 1 for branch <strong>FLOW3-1.1</strong> has been pushed to the review server.<br />It is available at <a class="external" href="../../external.html?link=http://review.typo3.org/12823">http://review.typo3.org/12823</a></p></div>
  </div>
  

  <div id="change-124363" class="journal has-details">
    <h4><a href="37574.html#note-18" class="journal-link">#18</a>
    
    <a name="note-18"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/10">Karsten Dambekalns</a> <a href="../../external.html?link=https://forge.typo3.org/projects/package-typo3-flow/activity?from=2012-07-18" title="2012-07-18 11:20">about 3 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Status</strong> changed from <i>Under Review</i> to <i>Resolved</i></li>
      
       <li><strong>Target version</strong> changed from <i>1.1</i> to <i>1.1 RC2</i></li>
      
    </ul>
    
    
  </div>
  




</div>



<div style="clear: both;"></div>
<div class="contextual">


<span class="issue-37574-watcher"></span>


</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:
  <span><a href="../../external.html?link=https://forge.typo3.org/issues/37574.atom" class="atom" rel="nofollow">Atom</a></span>
  <span><a href="37574.pdf" class="pdf" rel="nofollow">PDF</a></span>
</p>







<script type="text/javascript">
//<![CDATA[
new ContextMenu('/issues/context_menu')
//]]>
</script>

        
				<div style="clear:both;"></div>
    </div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>
	
<div id="footer">
 Powered by <a href="../../external.html?link=http://www.redmine.org/">Redmine</a> &copy; 2006-2012 Jean-Philippe Lang<br /><br />
 Hosting sponsor:<br /><br />
 <script type="text/javascript">var buttonStyle = "footer-grey-31";</script>
 <script src="../../typo3.org/fileadmin/t3org/images/FM-content/team-pages/server-team/sponsor-banners/sponsors.js"></script>
</div>
</div>

<script type="text/javascript">
    var pkBaseURL = (("https:" == document.location.protocol) ? "https://piwik.typo3.org/" : "http://piwik.typo3.org/");
    document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
    try {
        var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 14);
        piwikTracker.trackPageView();
        piwikTracker.enableLinkTracking();
    } catch( err ) {}
</script>
<noscript><span style="visibility: hidden";><img src="../../external.html?link=http://piwik.typo3.org/piwik.php?idsite=14" style="border:0" alt=""/></span></noscript>
</body>

<!-- Mirrored from forge.typo3.org/issues/37574 by HTTrack Website Copier/3.x [XR&CO'2008], Mon, 03 Aug 2015 22:00:47 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
</html>
