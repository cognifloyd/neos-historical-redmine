<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<!-- Mirrored from forge.typo3.org/issues/43725 by HTTrack Website Copier/3.x [XR&CO'2008], Mon, 03 Aug 2015 23:14:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>Bug #43725: TceformsUpdateWizard exceeds memory_limit/max_execution_time - Core - TYPO3 Forge</title>
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<link href="../themes/TYPO3/stylesheets/applicationfaba.css?1437165176" media="all" rel="stylesheet" type="text/css" />
<script src="../javascripts/prototypefaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/effectsfaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/dragdropfaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/controlsfaba.js?1437165176" type="text/javascript"></script>
<script src="../javascripts/applicationfaba.js?1437165176" type="text/javascript"></script>
<script src="../plugin_assets/flow_design_helpers/javascripts/custom-scriptsf881.js?1437165331" type="text/javascript"></script>

<!--[if IE]>
    <style type="text/css">
      * html body{ width: expression( document.documentElement.clientWidth < 900 ? '900px' : '100%' ); }
      body {behavior: url(/stylesheets/csshover.htc?1437165176);}
    </style>
<![endif]-->
 <link href="../plugin_assets/redmine_backlogs/stylesheets/jquery/jquery.jqplot.minb674.css?1437165332" media="screen" rel="stylesheet" type="text/css" />

<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery-1.6.2.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery-ui-1.8.16.custom.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jeditable.minib674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.scrollfollowb674.js?1437165332" type="text/javascript"></script>

<!--[if IE]>
<script src="/plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/excanvas.js?1437165332" type="text/javascript"></script>
<![endif]-->
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/jquery.jqplotb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.highlighterb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.canvasTextRenderer.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.canvasAxisTickRenderer.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.jqplot/plugins/jqplot.enhancedLegendRenderer.minb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/jquery/jquery.cookieb674.js?1437165332" type="text/javascript"></script>

<script type="text/javascript"
        src="../rb/server_variables.js">
</script>
<script src="../plugin_assets/redmine_backlogs/javascripts/commonb674.js?1437165332" type="text/javascript"></script>
<script src="../plugin_assets/redmine_backlogs/javascripts/burndownb674.js?1437165332" type="text/javascript"></script>


<style type="text/css">

</style>

<!-- page specific tags -->

    <link href="../../external.html?link=https://forge.typo3.org/issues/43725.atom" rel="alternate" title="Core - Bug #43725: TceformsUpdateWizard exceeds memory_limit/max_execution_time" type="application/atom+xml" />
    <link href="../themes/TYPO3/stylesheets/scmfaba.css?1437165176" media="screen" rel="stylesheet" type="text/css" />
<script src="../javascripts/context_menufaba.js?1437165176" type="text/javascript"></script><link href="../stylesheets/context_menufaba.css?1437165176" media="screen" rel="stylesheet" type="text/css" /><script src="../javascripts/jstoolbar/jstoolbarfaba.js?1437165176" type="text/javascript"></script><script src="../javascripts/jstoolbar/textilefaba.js?1437165176" type="text/javascript"></script><script src="../javascripts/jstoolbar/lang/jstoolbar-enfaba.js?1437165176" type="text/javascript"></script><link href="../stylesheets/jstoolbarfaba.css?1437165176" media="screen" rel="stylesheet" type="text/css" /></head>
<body>
<div id="wrapper">
<div id="top-menu">
    <div id="account">
        <ul><li><a href="../../external.html?link=https://forge.typo3.org/login" class="login">Sign in</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/account/register" class="register">Register</a></li></ul>    </div>
    
    <ul><li><a href="../../external.html?link=https://forge.typo3.org/" class="home">Home</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects" class="projects">Projects</a></li>
<li><a href="../../external.html?link=http://www.redmine.org/guide" class="help">Help</a></li></ul></div>
      
<div id="header">
    <div id="header-left">
        <div id="header-menu">
            <a href="../../external.html?link=https://forge.typo3.org/" class="start">Start</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms" class="level-0 current sorting-10">TYPO3 CMS</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3neos" class="level-0 sorting-20">TYPO3 Neos</a><a href="../../external.html?link=https://forge.typo3.org/projects/flow3" class="level-0 sorting-20">TYPO3 Flow</a><a href="../../external.html?link=https://forge.typo3.org/projects/team-docteam" class="level-0 sorting-26">Documentation</a><a href="../../external.html?link=https://forge.typo3.org/projects/other" class="level-0 sorting-30">other</a>
        </div>
    </div>
    
    <div id="right-area"  style="">
        <div id="quick-search">
            <form action="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/search" method="get">
            <input name="issues" type="hidden" value="1" />
            <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/search" accesskey="4" style="">Search</a>:
            <input accesskey="f" class="small" id="q" name="q" size="20" type="text" />
            </form>
        </div>

        <h1>Core</h1>
        <div id="quicklinks"><p>Development of TYPO3 CMS</p></div>
    </div>
    
    <div id="main-menu">
        <input class="projectsearch placeholder" id="projectname_project" name="projectname[project]" onfocus="this.value = &quot;&quot;; $(this).removeClassName(&quot;placeholder&quot;);" size="30" type="text" value="Project title search" /><div class="auto_complete" id="projectname_project_auto_complete"></div><script type="text/javascript">
//<![CDATA[
var projectname_project_auto_completer = new Ajax.Autocompleter('projectname_project', 'projectname_project_auto_complete', '/projects/auto_complete', {afterUpdateElement:function(element, value) { var identNode = $(value).select(".identifier"); window.location.href="/projects/"+identNode[0].innerHTML }})
//]]>
</script>
        <ul><li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core" class="overview">Overview</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity" class="activity">Activity</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/roadmap" class="roadmap">Roadmap</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues" class="issues selected">Issues</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/wiki" class="wiki">Wiki</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/repository" class="repository">Repository</a></li></ul>
    </div>
</div>

<div class="" id="main">
    <div id="leftmenu">
        <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core" class="level-1 current sorting-10">Core</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3v4-search" class="level-2 sorting-0">Indexed Search</a><a href="../../external.html?link=https://forge.typo3.org/projects/extension-linkvalidator" class="level-2 sorting-0">Linkvalidator</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-releasecycles" class="level-2 sorting-0">Release Cycles</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-team" class="level-2 sorting-0">Team Resources</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3v4-workspaces" class="level-2 sorting-0">Workspaces & Versioning</a><a href="../../external.html?link=https://forge.typo3.org/projects/usability" class="level-2 sorting-10">TYPO3 CMS Usability Team</a><a href="../../external.html?link=https://forge.typo3.org/projects/extensions" class="level-1 sorting-20">Community Extensions</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3v4-distribution" class="level-1 sorting-44">Distributions</a><a href="../../external.html?link=https://forge.typo3.org/projects/cms-feature-requests" class="level-1 sorting-50">Feature-Requests</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-v62" class="level-1 sorting-620">TYPO3 6.2 Projects (+)</a><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-archived" class="level-1 sorting-1000">(Archived Projects)</a>
    </div>
    <div id="sidebar">        
        
  <h3>Issues</h3>
<a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?set_filter=1">View all issues</a><br />

<a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues/report">Summary</a><br />







<h3>Custom queries</h3><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=219" class="query">Easy tasks</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=391" class="query">FAL Issues</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=133" class="query">Hierarchical Issues</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=322" class="query">Most wanted Bugfixes</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=321" class="query">Most wanted Features</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=167" class="query">My open issues</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=203" class="query">New &amp; Unassigned</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=90" class="query">Open Bugs</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=204" class="query">Recently modified</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=523" class="query">Regressions</a><br /><a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/issues?query_id=459" class="query">Roadmap v7</a>



  
    <div id="watchers">
      

<h3>Watchers (4)</h3>

<ul><li><a href="../../external.html?link=https://forge.typo3.org/users/320">Benjamin Mack</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/5239">Scanlitho no-lastname-given</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/3351">Markus Klein</a></li>
<li><a href="../../external.html?link=https://forge.typo3.org/users/39005">Adrien Jacob</a></li></ul>

    </div>
  

        
    </div>
    
    <div id="content">
				
        <div class="contextual">


<span class="issue-43725-watcher"></span>


</div>


<h2>Bug #43725</h2>

<div class="issue status-2 priority-1 child details">
  

  

<div class="subject">
<div><p><a href="57578.html" class="issue status-2 priority-2 parent">Task #57578</a>: TceformsUpdateWizard improvements (Migrate all file relations from tt_content.image and pages.media)</p><div><h3>TceformsUpdateWizard exceeds memory_limit/max_execution_time</h3></div></div>
</div>
        <p class="author">
        Added by <a href="../../external.html?link=https://forge.typo3.org/users/5239">Scanlitho no-lastname-given</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2012-12-07" title="2012-12-07 16:12">over 2 years</a> ago.
        
        Updated <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-12-23" title="2014-12-23 20:17">7 months</a> ago.
        
        </p>

<table class="attributes">
<tr>
    <th class="status">Status:</th><td class="status">Accepted</td>
    <th class="start-date">Start date:</th><td class="start-date">2012-12-07</td>
</tr>
<tr>
    <th class="priority">Priority:</th><td class="priority">Must have</td>
    <th class="due-date">Due date:</th><td class="due-date"></td>
</tr>
<tr>
    <th class="assigned-to">Assigned To:</th><td class="assigned-to">-</td>
    <th class="progress">% Done:</th><td class="progress"><table class="progress" style="width: 80px;"><tr><td class="todo" style="width: 100%;"></td></tr></table><p class="pourcent">0%</p></td>
</tr>
<tr>
    <th class="category">Category:</th><td class="category">Install Tool</td>
    
    <th class="spent-time">Spent time:</th>
    <td class="spent-time">-</td>
    
</tr>
<tr>
    <th class="fixed-version">Target version:</th><td class="fixed-version"><a href="../../external.html?link=https://forge.typo3.org/versions/2354">next-patchlevel</a></td>
    
</tr>
<tr>
	<th>TYPO3 Version:</th><td>6.2</td>
	<th>Is Regression:</th><td>No</td>
</tr>
<tr>
	<th>PHP Version:</th><td>5.3</td>
	<th>Sprint Focus:</th><td></td>
</tr>
<tr>
	<th>Complexity:</th><td></td>
</tr>


</table>

<hr />

  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>Hey,</p>


	<p>I have a very very big Website which I tried to Update to Typo3 6.0.<br />My test server throws an PHP Fatal error:<br />"Allowed memory size of 67108864 bytes exhausted."</p>


	<p>Server settings:<br />max_execution_time = 30<br />max_input_time = 60<br />memory_limit = 64M</p>


	<p>The refindex has 73,532 entrys and is 14,3 MB big.</p>


	<p>Maybe it would be better to let the function do only a limited number of query at each run? Is that even possible?</p>


	<p>Greetings</p>


	<p>Affected wizard: Migrate all file relations from tt_content.image and pages.media</p>
  </div>








<hr />
<div id="relations">
<div class="contextual">

</div>

<p><strong>Related issues</strong></p>


<form>
<table class="list issues">

<tr class="issue hascontextmenu" id="relation-10848">
<td class="checkbox"><input name="ids[]" type="checkbox" value="57393" /></td>
<td class="subject">related to 
    Core - 
    <a href="57393.html" class="issue status-7 priority-1 closed child">Bug #57393</a>: Endless Loop in TceformsUpdateWizard
</td>
<td class="status">Resolved</td>
<td class="start_date">2014-03-27</td>
<td class="due_date"></td>
<td class="buttons"></td>
</tr>

</table>
</form>


<form action="../../external.html?link=https://forge.typo3.org/issues/43725/relations" id="new-relation-form" method="post" onsubmit="new Ajax.Request('/issues/43725/relations', {asynchronous:true, evalScripts:true, method:'post', onComplete:function(request){Form.Element.focus('relation_issue_to_id');}, parameters:Form.serialize(this)}); return false;" style="display: none;"><div style="margin:0;padding:0;display:inline"><input name="authenticity_token" type="hidden" value="IjgAk+sryuS7AAkPn7/ITUV652f6cwFBHN6GNTvW7o8=" /></div>


<p><select id="relation_relation_type" name="relation[relation_type]" onchange="setPredecessorFieldsVisibility();"><option value="relates">related to</option>
<option value="duplicates">duplicates</option>
<option value="duplicated">duplicated by</option>
<option value="blocks">blocks</option>
<option value="blocked">blocked by</option>
<option value="precedes">precedes</option>
<option value="follows">follows</option></select>
Issue #<input id="relation_issue_to_id" name="relation[issue_to_id]" size="10" type="text" />
<span id="predecessor_fields" style="display:none;">
Delay: <input id="relation_delay" name="relation[delay]" size="3" type="text" /> days
</span>
<input name="commit" type="submit" value="Add" />
<a href="#" onclick="Element.toggle('new-relation-form'); this.blur(); return false;">Cancel</a>
</p>

<div id="related_issue_candidates" class="autocomplete"></div>
<script type="text/javascript">
//<![CDATA[
observeRelatedIssueField('/issues/auto_complete?id=43725&amp;project_id=typo3cms-core')
//]]>
</script>

<script type="text/javascript">
//<![CDATA[
setPredecessorFieldsVisibility();
//]]>
</script>

</form>

</div>


</div>




<div id="history">
<h3>History</h3>

  <div id="change-144706" class="journal has-details">
    <h4><a href="43725.html#note-1" class="journal-link">#1</a>
    
    <a name="note-1"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/5239">Scanlitho no-lastname-given</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2012-12-10" title="2012-12-10 12:31">over 2 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Project</strong> changed from <i>Core</i> to <i>File Abstraction Layer</i></li>
      
    </ul>
    
    
  </div>
  

  <div id="change-150717" class="journal has-notes has-details">
    <h4><a href="43725.html#note-2" class="journal-link">#2</a>
    
    <a name="note-2"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/43">Andreas Wolf</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2013-02-09" title="2013-02-09 17:14">over 2 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Status</strong> changed from <i>New</i> to <i>Needs Feedback</i></li>
      
    </ul>
    
    <div class="wiki" id="journal-150717-notes"><p>Sorry for not replying so long, but this tracker is only monitored from time to time now that FAL is part of the core.</p>


	<p>Regarding your problem: 64 MB is not too much for administrative tasks, so that might be one part of the problem.</p>


	<p>Could you give an estimate on the number of images that have to be migrated (i.e. how many files are in your <code>uploads/</code> folder)? The refindex size does not give a clue here.</p></div>
  </div>
  

  <div id="change-150718" class="journal has-details">
    <h4><a href="43725.html#note-3" class="journal-link">#3</a>
    
    <a name="note-3"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/43">Andreas Wolf</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2013-02-09" title="2013-02-09 17:14">over 2 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Project</strong> changed from <i>File Abstraction Layer</i> to <i>Core</i></li>
      
    </ul>
    
    
  </div>
  

  <div id="change-150870" class="journal has-notes">
    <h4><a href="43725.html#note-4" class="journal-link">#4</a>
    
    <a name="note-4"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/5239">Scanlitho no-lastname-given</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2013-02-11" title="2013-02-11 08:59">over 2 years</a> ago</h4>

    
    <div class="wiki" id="journal-150870-notes"><p>Hey Andreas,<br />in the upload folder are 18567 files.</p></div>
  </div>
  

  <div id="change-159378" class="journal has-notes">
    <h4><a href="43725.html#note-5" class="journal-link">#5</a>
    
    <a name="note-5"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/2597">Klaus Hinum</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2013-04-11" title="2013-04-11 21:44">over 2 years</a> ago</h4>

    
    <div class="wiki" id="journal-159378-notes"><p>Same problem here, got a huge website with 200 GB of images in the uploaded folder. I run out of memory altough memory_limit is currently 1 GB.</p></div>
  </div>
  

  <div id="change-178151" class="journal has-details">
    <h4><a href="43725.html#note-6" class="journal-link">#6</a>
    
    <a name="note-6"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/3767">Alexander Opitz</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2013-08-19" title="2013-08-19 14:30">almost 2 years</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Status</strong> changed from <i>Needs Feedback</i> to <i>New</i></li>
      
    </ul>
    
    
  </div>
  

  <div id="change-211571" class="journal has-details">
    <h4><a href="43725.html#note-7" class="journal-link">#7</a>
    
    <a name="note-7"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/3351">Markus Klein</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-04-02" title="2014-04-02 19:30">over 1 year</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Subject</strong> changed from <i>Migrate all file relations from tt_content.image and pages.media / Memory size</i> to <i>TceformsUpdateWizard exceeds memory_limit/max_execution_time</i></li>
      
       <li><strong>Category</strong> set to <i>Install Tool</i></li>
      
       <li><strong>Status</strong> changed from <i>New</i> to <i>Accepted</i></li>
      
       <li><strong>Target version</strong> set to <i>next-patchlevel</i></li>
      
       <li><strong>Parent task</strong> set to <i>#57578</i></li>
      
       <li><strong>TYPO3 Version</strong> changed from <i>6.1</i> to <i>6.2</i></li>
      
       <li><strong>Is Regression</strong> set to <i>No</i></li>
      
    </ul>
    
    
  </div>
  

  <div id="change-211572" class="journal has-notes">
    <h4><a href="43725.html#note-8" class="journal-link">#8</a>
    
    <a name="note-8"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/3351">Markus Klein</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-04-02" title="2014-04-02 19:32">over 1 year</a> ago</h4>

    
    <div class="wiki" id="journal-211572-notes"><p>I suggest to only migrate up to 4000 records per run.<br />The wizard should have a hint that it requires multiple runs. (auto reloading via redirect?)</p></div>
  </div>
  

  <div id="change-231416" class="journal has-notes">
    <h4><a href="43725.html#note-9" class="journal-link">#9</a>
    
    <a name="note-9"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/40927">Joshua Schäuble</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-09-30" title="2014-09-30 09:47">10 months</a> ago</h4>

    
    <div class="wiki" id="journal-231416-notes"><p>Klaus Hinum wrote:</p>


<blockquote>

	<p>Same problem here, got a huge website with 200 GB of images in the uploaded folder. I run out of memory altough memory_limit is currently 1 GB.</p>


</blockquote>

	<p>I've also got the same problem. Working on a migration of a big web page from 4.5 to 6.2 on a testserver. For the last run with 6.2.4 (PHP 5.4.30) the wizard run completely. Now I started over again with 6.2.5 and PHP 5.4.33 and I'm getting this error. The memory limit can't be the issue (tried around with up to 3GB) since its far from the allocation boundaries which the error gives. Also Downgraded PHP back to 5.4.30 with no effect.</p>


	<p><cite><br />Detected Fatal Error<br />Out of memory (allocated 107741184) (tried to allocate 86507504 bytes) in E:\wwwroot\typo3\sysext\install\Classes\Updates\TceformsUpdateWizard.php on line 336</cite></p>


	<p>Also "just to run it over and over again" has no effect. The sys_file_reference table constantly stays on 50 entries, although it should slowly go up to something around 100,000.</p></div>
  </div>
  

  <div id="change-231450" class="journal has-notes">
    <h4><a href="43725.html#note-10" class="journal-link">#10</a>
    
    <a name="note-10"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/3351">Markus Klein</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-09-30" title="2014-09-30 12:20">10 months</a> ago</h4>

    
    <div class="wiki" id="journal-231450-notes"><p>Thanks for your report Joshua.<br />Does it work if you downgrade to 6.2.4 (only replace the source) just for running the wizard?<br />If that is the case, we have some problem in the wizard introduced with 6.2.5.</p>


	<p>Particularly I'm thinking of <a href="57575.html" class="issue status-7 priority-1 closed child" title="TceformsUpdateWizard reports success although some migrations failed (Resolved)">#57575</a>, which introduced a big try...catch.</p></div>
  </div>
  

  <div id="change-231458" class="journal has-notes">
    <h4><a href="43725.html#note-11" class="journal-link">#11</a>
    
    <a name="note-11"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/40927">Joshua Schäuble</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-09-30" title="2014-09-30 13:42">10 months</a> ago</h4>

    
    <div class="wiki" id="journal-231458-notes"><p>Thanks for your fast reply.</p>


	<p>I've tried that and got the same error. The only other difference I had to previous attempts was some lowlevel_cleaner DB-cleaning (afaik everything was still running under 4.5 then), the new php 5.4.33 version (downgrading back had no effect) and 6.2.5 instead of 6.2.4. (downgrading back had no effect either). So probably the lowlever_cleaner makes the difference, still though I guess this error should not appear?</p>


	<p>I'm not sure what to try next. Either I start again with 6.2.5 and leave out the lowlevel_cleaner or I do the lowlevel_cleaner but use 6.2.4 and then upgdate to 6.2.5 after running the update wizard... Any other ideas?</p></div>
  </div>
  

  <div id="change-231459" class="journal has-notes">
    <h4><a href="43725.html#note-12" class="journal-link">#12</a>
    
    <a name="note-12"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/3351">Markus Klein</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-09-30" title="2014-09-30 13:47">10 months</a> ago</h4>

    
    <div class="wiki" id="journal-231459-notes"><p>Basically you should always use the latest TYPO3 version to upgrade, as it usually contains also the fixes for upgrade problems.<br />Changing the PHP version shouldn't cause massive memory leaks.</p>


	<p>What exactly did you do with the lowlevel_cleaner? Did you clean deleted records?</p></div>
  </div>
  

  <div id="change-231461" class="journal has-notes">
    <h4><a href="43725.html#note-13" class="journal-link">#13</a>
    
    <a name="note-13"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/40927">Joshua Schäuble</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-09-30" title="2014-09-30 14:00">10 months</a> ago</h4>

    
    <div class="wiki" id="journal-231461-notes"><p>Markus Klein wrote:</p>


<blockquote>

	<p>Basically you should always use the latest TYPO3 version to upgrade, as it usually contains also the fixes for upgrade problems.</p>


</blockquote>

	<p>Yep, that's why I did so when I started from scratch and a newer version was out.</p>


<blockquote>

	<p>What exactly did you do with the lowlevel_cleaner? Did you clean deleted records?</p>


</blockquote>

	<p>Yes I did. Did the following lowlevel tasks (in this order):</p>


	<p>orphan_records<br />versions<br />tx_templavoila_unusedce<br />deleted<br />missing_relations</p>


	<p>left out the other tasks for I didnt see a point after a dryrun. Especially the deleted records was the reason why I did it since the database is very bloated with records that are flagged as deleted and I hoped to speed up things by removing them (also some of the deleted records referenced missed files/deleted files, which caused problems)</p></div>
  </div>
  

  <div id="change-231464" class="journal has-notes">
    <h4><a href="43725.html#note-14" class="journal-link">#14</a>
    
    <a name="note-14"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/3351">Markus Klein</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-09-30" title="2014-09-30 14:46">10 months</a> ago</h4>

    
    <div class="wiki" id="journal-231464-notes"><p>Ok, so you cleaned away the deleted ones, that's already a good step.<br />Did update the reference index after the lowlevel commands as well?</p></div>
  </div>
  

  <div id="change-231469" class="journal has-notes">
    <h4><a href="43725.html#note-15" class="journal-link">#15</a>
    
    <a name="note-15"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/40927">Joshua Schäuble</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-09-30" title="2014-09-30 15:07">10 months</a> ago</h4>

    
    <div class="wiki" id="journal-231469-notes"><p>Yes and a DB compare in the install tool.</p>


	<p>I'll give a short description of how I went on after that (I hope this gives hints on what i'm doing wrong):</p>


	<p>After RefIndex update (integrity perfect) and DB compare (tables and field definitions are ok) I deleted "uninstalled extensions", updated those extensions that have a compatibility version (up to this point the 4.5 installation ran perfectly in the BE and FE), deleted all DAM-Extensions, updated the Reference Index again, solved all smoothmigration issues, updated the typo3 core, adjusted the "folder structure" (install tool) updated the reference index again, ran the update wizwards up to the wizard "rewrite binary file permissions into detailed list", filled sys_file by using the FAL scheduler task in the BE (otherwise "migrate all file relations from tt_content.image and pages.media" never worked for me) and updated the reference index again, then ran "migrate all file relations from tt_content.image and pages.media". --> given error</p>


	<p>In previous attempts this worked fine so I sucessfully finished the update wizards and went on with DAM->FAL and our extension adjustment (which is what I was working on before I restarted). There I got some problems (double relations due to "pre-DAM"-fallbacks in the 4.5 Setup etc... just case-specific issues that made me believe it would be easier to first delete "deleted records", especially since a new 6.2.5 was out anyway) that caused me to start again and now i'm a bit stuck.</p></div>
  </div>
  

  <div id="change-231775" class="journal has-notes">
    <h4><a href="43725.html#note-16" class="journal-link">#16</a>
    
    <a name="note-16"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/3351">Markus Klein</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-10-02" title="2014-10-02 17:15">10 months</a> ago</h4>

    
    <div class="wiki" id="journal-231775-notes"><p>Uff... that's somehow weird.</p>


	<p>From my experience I can only say: Never ever update the reference index after switching the source.</p>


	<p>I've no experience with DAM, so I don know if it's necessary to uninstall the extension, but I guess you'll need to.</p>


	<p>These steps should actually suffice:</p>


	<ul>
	<li>Uninstall extensions</li>
		<li>Clean deleted records</li>
		<li>DB compare</li>
		<li>RefIndex update</li>
		<li>Update source</li>
		<li>(fix folder structure)</li>
		<li>Run upgrade wizards</li>
	</ul>


	<p>Whenever you do anything content/file related while the FAL tables are not migrated/filled correctly, you will end up in a data mess.</p></div>
  </div>
  

  <div id="change-231990" class="journal has-notes">
    <h4><a href="43725.html#note-17" class="journal-link">#17</a>
    
    <a name="note-17"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/40927">Joshua Schäuble</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-10-06" title="2014-10-06 09:20">10 months</a> ago</h4>

    
    <div class="wiki" id="journal-231990-notes"><p>Well, the problem is, that if I uninstall DAM (and all the other DAM related extensions) before I clean deleted records/do a db compare the DAM-references in the DB get messed up and I can't migrate them after the update wizards anymore. Besides that it also seems impossible to not do a RefIndex update after the source update: sys_file does not fill up automatically (50,000entries) so I need to run the scheduler FAL-task, but this one doesn't run through without a ref-Index update. And without sys_file being filled it is impossible to run the "migrate all file relations from tt_content.image and pages.media" update wizard. Therefore RefIndex -> Scheduler Task -> file relation wizard seemed the most logical order and worked so far, I had no data mess in the end.</p>


	<p>Over the weekend I tried to set up everything the way I did before (old php/mysql version, no deleted record removal) and it is still getting the same error although it ran through that way before I restarted. Therefor I think it is not actually Typo3-migration related but rather a server issue that I am just not aware of. With updating mysql/php something must have changed that by resetting them to the old versions doesnt reset.  Checked weather the right my.ini is loaded, checked phpinfo(), watched what happens to the memory when running the wizard (not even running full), checked what happens to the DB when running the wizard (sys_file_references always stops running full at entry uid 50, after like 5 seconds, while the error in the install tool only appears after 10 minutes! In these 10 minutes I have no idea whatsoever what the wizard is doing)</p>


	<p>We're thinking of starting it again on another local mashine, but if this works it would unfortunatelly still not help to get rid of this general bug or to understand better in what cases it occurs.</p>


	<p>Edit: It might be important to mention that we're running on a Windows-Server and therefore also on Windows locally.</p></div>
  </div>
  

  <div id="change-232129" class="journal has-notes">
    <h4><a href="43725.html#note-18" class="journal-link">#18</a>
    
    <a name="note-18"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/40927">Joshua Schäuble</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-10-07" title="2014-10-07 12:16">10 months</a> ago</h4>

    
    <div class="wiki" id="journal-232129-notes"><p>I found the reason in our case: In tt_content.image we had some "NULL" strings instead of NULL-values which caused the wizard to fail. I do not know though, why this didn't cause a wizard crash before since these values must have been in there before(maybe due to a mysql update?). Now the wizard ran through. I'm not sure if weird tt_content.image values should cause the wizard to crash with a "memory allocation" error but I guess its fair.</p>


	<p>Thanks again for your help.</p></div>
  </div>
  

  <div id="change-232449" class="journal has-notes">
    <h4><a href="43725.html#note-19" class="journal-link">#19</a>
    
    <a name="note-19"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/3351">Markus Klein</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-10-10" title="2014-10-10 15:45">10 months</a> ago</h4>

    
    <div class="wiki" id="journal-232449-notes"><p>This is indeed strange and it is even stranger, how these stringified NULL values came into the DB.<br />I've no clue though, why the script runs out of memory in such a case, because missing images are reported in the logfile usually.</p></div>
  </div>
  

  <div id="change-242376" class="journal has-details">
    <h4><a href="43725.html#note-20" class="journal-link">#20</a>
    
    <a name="note-20"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/33">Mathias Schreiber</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-12-23" title="2014-12-23 19:56">7 months</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Target version</strong> changed from <i>next-patchlevel</i> to <i>7.4 (Backend)</i></li>
      
    </ul>
    
    
  </div>
  

  <div id="change-242426" class="journal has-notes has-details">
    <h4><a href="43725.html#note-21" class="journal-link">#21</a>
    
    <a name="note-21"></a>
    Updated by <a href="../../external.html?link=https://forge.typo3.org/users/3351">Markus Klein</a> <a href="../../external.html?link=https://forge.typo3.org/projects/typo3cms-core/activity?from=2014-12-23" title="2014-12-23 20:17">7 months</a> ago</h4>

    
    <ul class="details">
      
       <li><strong>Target version</strong> changed from <i>7.4 (Backend)</i> to <i>next-patchlevel</i></li>
      
    </ul>
    
    <div class="wiki" id="journal-242426-notes"><p>Setting target version back to next-patchlevel as this code does not exist in CMS 7 anymore.<br />Once there is some dedicated target version for 6.2, please change it again.</p></div>
  </div>
  




</div>



<div style="clear: both;"></div>
<div class="contextual">


<span class="issue-43725-watcher"></span>


</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:
  <span><a href="../../external.html?link=https://forge.typo3.org/issues/43725.atom" class="atom" rel="nofollow">Atom</a></span>
  <span><a href="43725.pdf" class="pdf" rel="nofollow">PDF</a></span>
</p>







<script type="text/javascript">
//<![CDATA[
new ContextMenu('/issues/context_menu')
//]]>
</script>

        
				<div style="clear:both;"></div>
    </div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>
	
<div id="footer">
 Powered by <a href="../../external.html?link=http://www.redmine.org/">Redmine</a> &copy; 2006-2012 Jean-Philippe Lang<br /><br />
 Hosting sponsor:<br /><br />
 <script type="text/javascript">var buttonStyle = "footer-grey-31";</script>
 <script src="../../typo3.org/fileadmin/t3org/images/FM-content/team-pages/server-team/sponsor-banners/sponsors.js"></script>
</div>
</div>

<script type="text/javascript">
    var pkBaseURL = (("https:" == document.location.protocol) ? "https://piwik.typo3.org/" : "http://piwik.typo3.org/");
    document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
    try {
        var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 14);
        piwikTracker.trackPageView();
        piwikTracker.enableLinkTracking();
    } catch( err ) {}
</script>
<noscript><span style="visibility: hidden";><img src="../../external.html?link=http://piwik.typo3.org/piwik.php?idsite=14" style="border:0" alt=""/></span></noscript>
</body>

<!-- Mirrored from forge.typo3.org/issues/43725 by HTTrack Website Copier/3.x [XR&CO'2008], Mon, 03 Aug 2015 23:14:01 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
</html>
